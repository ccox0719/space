{
  "version": 3,
  "sources": ["../galaxyGenerator.ts", "../galaxy_generator.json", "../src/rng/SeededRng.ts", "../event_system.json", "../reputation_engine.json", "../src/systems/PlayerState.ts", "../career_system.json", "../src/systems/MissionSystem.ts", "../src/systems/RiskSystem.ts", "../src/systems/math.ts", "../src/systems/EscapeSystem.ts", "../src/systems/EventEngine.ts", "../src/systems/TravelSystem.ts", "../src/data/commodities.json", "../src/systems/EconomySystem.ts", "../src/systems/CombatSystem.ts", "client.ts"],
  "sourcesContent": ["// galaxyGenerator.ts\nimport {\n  GalaxyConfig,\n  Galaxy,\n  Sector,\n  SectorType,\n  Faction,\n  GeneratorConfig,\n  DangerLevel,\n  LawLevel\n} from \"./galaxyTypes\";\n\nfunction seededRandom(seed: number): () => number {\n  // Simple deterministic PRNG (xorshift-like)\n  let x = seed || Date.now();\n  return () => {\n    x ^= x << 13;\n    x ^= x >> 17;\n    x ^= x << 5;\n    // force positive and normalize\n    return (x >>> 0) / 0xffffffff;\n  };\n}\n\nfunction weightedRandom<T extends string | number>(\n  rng: () => number,\n  weights: Record<T, number>\n): T {\n  let total = 0;\n  for (const k in weights) total += weights[k];\n  const roll = rng() * total;\n  let cumulative = 0;\n  for (const k in weights) {\n    cumulative += weights[k];\n    if (roll <= cumulative) return k;\n  }\n  // fallback (shouldn't happen)\n  return Object.keys(weights)[0] as T;\n}\n\nexport class GalaxyGenerator {\n  private config: GalaxyConfig;\n  private rng: () => number;\n  private generatorConfig: GeneratorConfig;\n  private factionById: Map<string, Faction>;\n  private sectorTypeById: Map<string, SectorType>;\n\n  constructor(config: GalaxyConfig, seed: number = Date.now()) {\n    this.config = config;\n    this.rng = seededRandom(seed);\n    this.generatorConfig = config.generatorConfig;\n\n    this.factionById = new Map(\n      config.factions.map((f) => [f.id, f])\n    );\n    this.sectorTypeById = new Map(\n      config.sectorTypes.map((st) => [st.id, st])\n    );\n  }\n\n  generate(size?: keyof GeneratorConfig[\"galaxySize\"]): Galaxy {\n    const chosenSize = size || this.generatorConfig.defaultSize;\n    const sectorCount =\n      this.generatorConfig.galaxySize[chosenSize].sectors;\n\n    const sectors: Sector[] = [];\n\n    // 1) Create base sectors with random types + factions + coords\n    for (let i = 0; i < sectorCount; i++) {\n      const sectorTypeId = weightedRandom(\n        this.rng,\n        this.generatorConfig.sectorTypeWeights\n      );\n      const sectorType = this.sectorTypeById.get(sectorTypeId);\n      if (!sectorType) {\n        throw new Error(`Unknown sector type: ${sectorTypeId}`);\n      }\n\n      const factionId = this.pickFactionForSectorType(sectorTypeId);\n      const { danger, law } = this.applyLawDangerOverrides(\n        sectorType,\n        factionId\n      );\n\n      const coords = this.generateCoords(i, sectorCount);\n\n      const sector: Sector = {\n        id: this.generateSectorId(sectorTypeId, i),\n        name: this.generateSectorName(sectorType, i),\n        typeId: sectorTypeId,\n        factionId,\n        danger,\n        law,\n        resourceRichness: sectorType.resourceRichness,\n        marketProfile: sectorType.marketProfile,\n        coords,\n        tags: [...sectorType.tags],\n        connections: [],\n        localModifiers: {\n          events: { ...(sectorType.eventWeightModifiers || {}) }\n        },\n        pointsOfInterest: []\n      };\n\n      sectors.push(sector);\n    }\n\n    // 2) Wire up sector connections (graph edges)\n    this.connectSectors(sectors);\n\n    // 3) Optionally, add a few POIs based on type\n    this.addBasicPointsOfInterest(sectors);\n\n    // 4) Create final galaxy object\n    const galaxy: Galaxy = {\n      id: `galaxy_seed_${Math.floor(this.rng() * 100000)}`,\n      size: chosenSize,\n      sectors,\n      factions: this.config.factions\n    };\n\n    return galaxy;\n  }\n\n  // ---- Helpers ---------------------------------------------------\n\n  private pickFactionForSectorType(sectorTypeId: string): string | null {\n    const spread = this.generatorConfig.factionSpread;\n    const weights: Record<string, number> = {};\n\n    for (const factionId in spread) {\n      const map = spread[factionId];\n      const w = map[sectorTypeId];\n      if (w && w > 0) {\n        weights[factionId] = w;\n      }\n    }\n\n    if (Object.keys(weights).length === 0) {\n      return null; // unclaimed\n    }\n\n    return weightedRandom(this.rng, weights);\n  }\n\n  private applyLawDangerOverrides(\n    sectorType: SectorType,\n    factionId: string | null\n  ): { danger: DangerLevel; law: LawLevel } {\n    const overrides = this.generatorConfig.lawDangerOverrides;\n    let danger = sectorType.baseDanger as DangerLevel;\n    let law =\n      sectorType.baseLaw === \"none\" || sectorType.baseLaw === \"very_low\"\n        ? (sectorType.baseLaw as LawLevel)\n        : (sectorType.baseLaw as LawLevel);\n\n    if (sectorType.id === \"pirate_stronghold\") {\n      law = overrides.pirateStrongholdLaw;\n      danger = \"high\";\n    } else if (sectorType.id === \"dead_system\") {\n      law = overrides.deadSystemLaw;\n      danger = \"high\";\n    } else if (sectorType.id === \"core_trade_hub\") {\n      law = overrides.coreTradeHubLaw;\n    }\n\n    // You could further tweak danger/law by faction if you want\n\n    return { danger, law };\n  }\n\n  private generateCoords(\n    index: number,\n    total: number\n  ): { x: number; y: number } {\n    // Rough radial layout\n    const angle = (2 * Math.PI * index) / total;\n    const radius = 5 + this.rng() * 10;\n    const x = Math.round(Math.cos(angle) * radius);\n    const y = Math.round(Math.sin(angle) * radius);\n    return { x, y };\n  }\n\n  private generateSectorId(typeId: string, index: number): string {\n    return `${typeId}_${index}`;\n  }\n\n  private generateSectorName(type: SectorType, index: number): string {\n    // Placeholder naming scheme; you can swap for something cooler\n    const base = type.name.split(\" \")[0]; // e.g. \"Core\", \"Mining\", etc.\n    const suffix = 100 + index;\n    return `${base} Sector ${suffix}`;\n  }\n\n  private connectSectors(sectors: Sector[]): void {\n    const rules = this.generatorConfig.connectionRules;\n    const n = sectors.length;\n\n    // Helper: distance between two sectors\n    const dist = (a: Sector, b: Sector) => {\n      const dx = a.coords.x - b.coords.x;\n      const dy = a.coords.y - b.coords.y;\n      return Math.sqrt(dx * dx + dy * dy);\n    };\n\n    // First pass: ensure each sector has at least minConnectionsPerSector\n    for (let i = 0; i < n; i++) {\n      const sector = sectors[i];\n      while (sector.connections.length < rules.minConnectionsPerSector) {\n        // Find the nearest sector not already connected\n        let bestIdx = -1;\n        let bestDist = Infinity;\n        for (let j = 0; j < n; j++) {\n          if (j === i) continue;\n          const other = sectors[j];\n          if (sector.connections.includes(other.id)) continue;\n          const d = dist(sector, other);\n          if (d < bestDist) {\n            bestDist = d;\n            bestIdx = j;\n          }\n        }\n        if (bestIdx === -1) break; // shouldn't happen\n        const other = sectors[bestIdx];\n        this.linkSectors(sector, other);\n      }\n    }\n\n    // Second pass: randomly add extra connections up to maxConnectionsPerSector\n    for (let i = 0; i < n; i++) {\n      const sector = sectors[i];\n      const currentConnections = sector.connections.length;\n      const maxExtra =\n        rules.maxConnectionsPerSector - currentConnections;\n      if (maxExtra <= 0) continue;\n      const extras = Math.floor(this.rng() * (maxExtra + 1));\n      for (let e = 0; e < extras; e++) {\n        const j = Math.floor(this.rng() * n);\n        if (j === i) continue;\n        const other = sectors[j];\n        if (sector.connections.includes(other.id)) continue;\n        this.linkSectors(sector, other);\n      }\n    }\n  }\n\n  private linkSectors(a: Sector, b: Sector): void {\n    if (!a.connections.includes(b.id)) a.connections.push(b.id);\n    if (!b.connections.includes(a.id)) b.connections.push(a.id);\n  }\n\n  private addBasicPointsOfInterest(sectors: Sector[]): void {\n    for (const sector of sectors) {\n      if (!sector.pointsOfInterest) sector.pointsOfInterest = [];\n      // Very simple example: add POIs based on type\n      if (sector.typeId === \"core_trade_hub\") {\n        sector.pointsOfInterest.push({\n          id: `${sector.id}_exchange`,\n          type: \"market\",\n          name: `${sector.name} Exchange`,\n          effects: {\n            tradeBonus: 0.1,\n            missionBoard: [\"contract_delivery\", \"speculation_run\"]\n          }\n        });\n      } else if (sector.typeId === \"mining_belt\") {\n        sector.pointsOfInterest.push({\n          id: `${sector.id}_mining_hub`,\n          type: \"station\",\n          name: `${sector.name} Mining Hub`,\n          effects: {\n            miningContractsBoard: [\n              \"mining_contract\",\n              \"deep_core_mining\"\n            ]\n          }\n        });\n      } else if (sector.typeId === \"pirate_stronghold\") {\n        sector.pointsOfInterest.push({\n          id: `${sector.id}_black_market`,\n          type: \"black_market\",\n          name: `${sector.name} Black Ring`,\n          effects: {\n            blackMarketAccess: [\n              \"basic_contraband\",\n              \"weapon_upgrades\"\n            ]\n          }\n        });\n      }\n      // You can extend this with more rules per type or faction\n    }\n  }\n}\n", "{\n  \"factions\": [\n    {\n      \"id\": \"helion_republic\",\n      \"name\": \"Helion Republic\",\n      \"type\": \"government\",\n      \"description\": \"A trade-focused democratic republic controlling many core systems.\",\n      \"reputationTrack\": \"navy\",\n      \"primaryAlignments\": [\"law\"],\n      \"tags\": [\"lawful\", \"trade\", \"navy\"],\n      \"color\": \"#4BA3FF\"\n    },\n    {\n      \"id\": \"rift_syndicate\",\n      \"name\": \"Rift Syndicate\",\n      \"type\": \"criminal\",\n      \"description\": \"A loose coalition of pirate clans, smugglers, and black market brokers.\",\n      \"reputationTrack\": \"syndicate\",\n      \"primaryAlignments\": [\"chaos\"],\n      \"tags\": [\"pirate\", \"smuggling\", \"underworld\"],\n      \"color\": \"#D13B3B\"\n    },\n    {\n      \"id\": \"unity_church\",\n      \"name\": \"Unity Church\",\n      \"type\": \"religious\",\n      \"description\": \"A theocratic order blending biotech and spirituality.\",\n      \"reputationTrack\": \"researcher\",\n      \"primaryAlignments\": [\"law\"],\n      \"tags\": [\"biotech\", \"pious\", \"zealots\"],\n      \"color\": \"#F2D15B\"\n    },\n    {\n      \"id\": \"celestial_directorate\",\n      \"name\": \"Celestial Directorate\",\n      \"type\": \"technocracy\",\n      \"description\": \"An AI-steered technocratic state focused on research and control.\",\n      \"reputationTrack\": \"researcher\",\n      \"primaryAlignments\": [\"law\"],\n      \"tags\": [\"high_tech\", \"ai\", \"strict\"],\n      \"color\": \"#9E68FF\"\n    },\n    {\n      \"id\": \"frontier_clans\",\n      \"name\": \"Frontier Clans\",\n      \"type\": \"frontier\",\n      \"description\": \"Independent miners, haulers, and settlers in the outer belts.\",\n      \"reputationTrack\": \"miner\",\n      \"primaryAlignments\": [\"neutral\"],\n      \"tags\": [\"mining\", \"frontier\", \"scrappy\"],\n      \"color\": \"#7BC76E\"\n    }\n  ],\n\n  \"sectorTypes\": [\n    {\n      \"id\": \"core_trade_hub\",\n      \"name\": \"Core Trade Hub\",\n      \"description\": \"Highly populated, safe systems with strong law enforcement and busy markets.\",\n      \"baseDanger\": \"low\",\n      \"baseLaw\": \"high\",\n      \"resourceRichness\": {\n        \"minerals\": \"low\",\n        \"gas\": \"low\",\n        \"salvage\": \"low\",\n        \"anomalies\": \"low\"\n      },\n      \"marketProfile\": {\n        \"volume\": \"very_high\",\n        \"priceVolatility\": \"low\",\n        \"illegalTolerance\": \"very_low\"\n      },\n      \"preferredFactions\": [\"helion_republic\", \"celestial_directorate\"],\n      \"eventWeightModifiers\": {\n        \"piracy\": 0.4,\n        \"law_enforcement\": 1.8,\n        \"market\": 1.6,\n        \"smuggling\": 0.4\n      },\n      \"tags\": [\"core\", \"trade\", \"safe\"]\n    },\n    {\n      \"id\": \"industrial_world\",\n      \"name\": \"Industrial World\",\n      \"description\": \"Manufacturing-focused system with moderate law and strong demand for resources.\",\n      \"baseDanger\": \"medium\",\n      \"baseLaw\": \"medium\",\n      \"resourceRichness\": {\n        \"minerals\": \"medium\",\n        \"gas\": \"low\",\n        \"salvage\": \"medium\",\n        \"anomalies\": \"low\"\n      },\n      \"marketProfile\": {\n        \"volume\": \"high\",\n        \"priceVolatility\": \"medium\",\n        \"illegalTolerance\": \"low\"\n      },\n      \"preferredFactions\": [\"helion_republic\", \"frontier_clans\"],\n      \"eventWeightModifiers\": {\n        \"piracy\": 1.1,\n        \"law_enforcement\": 1.2,\n        \"market\": 1.3,\n        \"mining\": 1.1\n      },\n      \"tags\": [\"industry\", \"manufacturing\"]\n    },\n    {\n      \"id\": \"mining_belt\",\n      \"name\": \"Mining Belt\",\n      \"description\": \"Dense asteroid fields and refineries, rich in minerals but risky to traverse.\",\n      \"baseDanger\": \"medium\",\n      \"baseLaw\": \"low\",\n      \"resourceRichness\": {\n        \"minerals\": \"very_high\",\n        \"gas\": \"medium\",\n        \"salvage\": \"medium\",\n        \"anomalies\": \"medium\"\n      },\n      \"marketProfile\": {\n        \"volume\": \"medium\",\n        \"priceVolatility\": \"high\",\n        \"illegalTolerance\": \"medium\"\n      },\n      \"preferredFactions\": [\"frontier_clans\", \"helion_republic\"],\n      \"eventWeightModifiers\": {\n        \"mining\": 2.0,\n        \"piracy\": 1.4,\n        \"salvage\": 1.3,\n        \"law_enforcement\": 0.7\n      },\n      \"tags\": [\"mining\", \"frontier\"]\n    },\n    {\n      \"id\": \"pirate_stronghold\",\n      \"name\": \"Pirate Stronghold\",\n      \"description\": \"Lawless sectors controlled by pirate clans and smugglers.\",\n      \"baseDanger\": \"high\",\n      \"baseLaw\": \"very_low\",\n      \"resourceRichness\": {\n        \"minerals\": \"low\",\n        \"gas\": \"low\",\n        \"salvage\": \"high\",\n        \"anomalies\": \"medium\"\n      },\n      \"marketProfile\": {\n        \"volume\": \"medium\",\n        \"priceVolatility\": \"high\",\n        \"illegalTolerance\": \"very_high\"\n      },\n      \"preferredFactions\": [\"rift_syndicate\"],\n      \"eventWeightModifiers\": {\n        \"piracy\": 2.5,\n        \"smuggling\": 2.0,\n        \"law_enforcement\": 0.2,\n        \"combat\": 1.5,\n        \"salvage\": 1.2\n      },\n      \"tags\": [\"pirate\", \"black_market\", \"dangerous\"]\n    },\n    {\n      \"id\": \"research_node\",\n      \"name\": \"Research Node\",\n      \"description\": \"High-tech system full of labs, observatories, and classified projects.\",\n      \"baseDanger\": \"low\",\n      \"baseLaw\": \"high\",\n      \"resourceRichness\": {\n        \"minerals\": \"low\",\n        \"gas\": \"low\",\n        \"salvage\": \"low\",\n        \"anomalies\": \"high\"\n      },\n      \"marketProfile\": {\n        \"volume\": \"medium\",\n        \"priceVolatility\": \"low\",\n        \"illegalTolerance\": \"low\"\n      },\n      \"preferredFactions\": [\"celestial_directorate\", \"unity_church\"],\n      \"eventWeightModifiers\": {\n        \"exploration\": 1.8,\n        \"rare_story\": 1.5,\n        \"research_support\": 2.0,\n        \"piracy\": 0.6\n      },\n      \"tags\": [\"research\", \"science\", \"ai\"]\n    },\n    {\n      \"id\": \"frontier_outpost\",\n      \"name\": \"Frontier Outpost\",\n      \"description\": \"Sparse but strategic system on the edge of known space.\",\n      \"baseDanger\": \"medium\",\n      \"baseLaw\": \"low\",\n      \"resourceRichness\": {\n        \"minerals\": \"medium\",\n        \"gas\": \"medium\",\n        \"salvage\": \"medium\",\n        \"anomalies\": \"medium\"\n      },\n      \"marketProfile\": {\n        \"volume\": \"low\",\n        \"priceVolatility\": \"high\",\n        \"illegalTolerance\": \"medium\"\n      },\n      \"preferredFactions\": [\"frontier_clans\"],\n      \"eventWeightModifiers\": {\n        \"exploration\": 1.4,\n        \"mining\": 1.4,\n        \"piracy\": 1.3,\n        \"salvage\": 1.3\n      },\n      \"tags\": [\"frontier\", \"outpost\"]\n    },\n    {\n      \"id\": \"dead_system\",\n      \"name\": \"Dead System\",\n      \"description\": \"An abandoned or dead system with no permanent population.\",\n      \"baseDanger\": \"high\",\n      \"baseLaw\": \"none\",\n      \"resourceRichness\": {\n        \"minerals\": \"low\",\n        \"gas\": \"low\",\n        \"salvage\": \"very_high\",\n        \"anomalies\": \"high\"\n      },\n      \"marketProfile\": {\n        \"volume\": \"none\",\n        \"priceVolatility\": \"none\",\n        \"illegalTolerance\": \"n_a\"\n      },\n      \"preferredFactions\": [],\n      \"eventWeightModifiers\": {\n        \"salvage\": 2.2,\n        \"exploration\": 1.7,\n        \"rare_story\": 1.4,\n        \"piracy\": 0.8\n      },\n      \"tags\": [\"dead\", \"derelicts\", \"anomalies\"]\n    }\n  ],\n\n  \"generatorConfig\": {\n    \"galaxySize\": {\n      \"small\": { \"sectors\": 16 },\n      \"medium\": { \"sectors\": 24 },\n      \"large\": { \"sectors\": 36 }\n    },\n    \"defaultSize\": \"medium\",\n\n    \"sectorTypeWeights\": {\n      \"core_trade_hub\": 3,\n      \"industrial_world\": 4,\n      \"mining_belt\": 4,\n      \"pirate_stronghold\": 3,\n      \"research_node\": 2,\n      \"frontier_outpost\": 4,\n      \"dead_system\": 2\n    },\n\n    \"factionSpread\": {\n      \"helion_republic\": {\n        \"core_trade_hub\": 0.6,\n        \"industrial_world\": 0.4,\n        \"frontier_outpost\": 0.2\n      },\n      \"rift_syndicate\": {\n        \"pirate_stronghold\": 0.7,\n        \"frontier_outpost\": 0.3\n      },\n      \"unity_church\": {\n        \"research_node\": 0.5,\n        \"industrial_world\": 0.3,\n        \"core_trade_hub\": 0.2\n      },\n      \"celestial_directorate\": {\n        \"research_node\": 0.7,\n        \"core_trade_hub\": 0.3\n      },\n      \"frontier_clans\": {\n        \"mining_belt\": 0.6,\n        \"frontier_outpost\": 0.6,\n        \"dead_system\": 0.2\n      }\n    },\n\n    \"connectionRules\": {\n      \"minConnectionsPerSector\": 2,\n      \"maxConnectionsPerSector\": 5,\n      \"coreClusterSize\": 4,\n      \"frontierDistanceMin\": 3,\n      \"frontierDistanceMax\": 6\n    },\n\n    \"lawDangerOverrides\": {\n      \"lawLevels\": [\"none\", \"very_low\", \"low\", \"medium\", \"high\"],\n      \"dangerLevels\": [\"low\", \"medium\", \"high\"],\n      \"pirateStrongholdLaw\": \"very_low\",\n      \"deadSystemLaw\": \"none\",\n      \"coreTradeHubLaw\": \"high\"\n    }\n  },\n\n  \"exampleGeneratedGalaxy\": {\n    \"id\": \"galaxy_seed_72193\",\n    \"size\": \"medium\",\n    \"sectors\": [\n      {\n        \"id\": \"helion_prime\",\n        \"name\": \"Helion Prime\",\n        \"typeId\": \"core_trade_hub\",\n        \"factionId\": \"helion_republic\",\n        \"danger\": \"low\",\n        \"law\": \"high\",\n        \"coords\": { \"x\": 0, \"y\": 0 },\n        \"tags\": [\"core\", \"capital\"],\n        \"connections\": [\"unity_station\", \"keth_gate\", \"orion_exchange\"],\n        \"localModifiers\": {\n          \"market\": { \"volume\": \"very_high\" },\n          \"events\": { \"law_enforcement\": 2.0, \"piracy\": 0.3 }\n        },\n        \"pointsOfInterest\": [\n          {\n            \"id\": \"helion_exchange\",\n            \"type\": \"market\",\n            \"name\": \"Helion Grand Exchange\",\n            \"effects\": {\n              \"tradeBonus\": 0.1,\n              \"missionBoard\": [\"contract_delivery\", \"speculation_run\"]\n            }\n          },\n          {\n            \"id\": \"navy_office\",\n            \"type\": \"navy_hq\",\n            \"name\": \"Helion Navy Command\",\n            \"effects\": {\n              \"missionBoard\": [\"sector_patrol\", \"frontline_conflict\"]\n            }\n          }\n        ]\n      },\n      {\n        \"id\": \"unity_station\",\n        \"name\": \"Unity Station\",\n        \"typeId\": \"research_node\",\n        \"factionId\": \"unity_church\",\n        \"danger\": \"low\",\n        \"law\": \"high\",\n        \"coords\": { \"x\": 1, \"y\": 2 },\n        \"tags\": [\"research\", \"pilgrimage\"],\n        \"connections\": [\"helion_prime\", \"aurora_belt\"],\n        \"localModifiers\": {\n          \"events\": { \"exploration\": 1.6, \"rare_story\": 1.4 }\n        },\n        \"pointsOfInterest\": [\n          {\n            \"id\": \"bio_temple\",\n            \"type\": \"lab\",\n            \"name\": \"Temple of Living Code\",\n            \"effects\": {\n              \"dataSellMultiplier\": 1.3\n            }\n          }\n        ]\n      },\n      {\n        \"id\": \"aurora_belt\",\n        \"name\": \"Aurora Belt\",\n        \"typeId\": \"mining_belt\",\n        \"factionId\": \"frontier_clans\",\n        \"danger\": \"medium\",\n        \"law\": \"low\",\n        \"coords\": { \"x\": 3, \"y\": 3 },\n        \"tags\": [\"mining\"],\n        \"connections\": [\"unity_station\", \"keth_gate\"],\n        \"localModifiers\": {\n          \"events\": { \"mining\": 2.2, \"piracy\": 1.3 }\n        },\n        \"pointsOfInterest\": [\n          {\n            \"id\": \"clan_hub\",\n            \"type\": \"station\",\n            \"name\": \"Clan Hub Delta\",\n            \"effects\": {\n              \"miningContractsBoard\": [\"mining_contract\", \"deep_core_mining\"]\n            }\n          }\n        ]\n      },\n      {\n        \"id\": \"keth_gate\",\n        \"name\": \"Keth Gate\",\n        \"typeId\": \"frontier_outpost\",\n        \"factionId\": \"frontier_clans\",\n        \"danger\": \"medium\",\n        \"law\": \"low\",\n        \"coords\": { \"x\": -2, \"y\": -1 },\n        \"tags\": [\"frontier\"],\n        \"connections\": [\"helion_prime\", \"aurora_belt\", \"rift_den\"],\n        \"localModifiers\": {\n          \"events\": { \"salvage\": 1.3, \"piracy\": 1.2 }\n        },\n        \"pointsOfInterest\": [\n          {\n            \"id\": \"transit_bar\",\n            \"type\": \"bar\",\n            \"name\": \"The Last Stable Orbit\",\n            \"effects\": {\n              \"crewRecruitment\": true\n            }\n          }\n        ]\n      },\n      {\n        \"id\": \"rift_den\",\n        \"name\": \"Rift Den\",\n        \"typeId\": \"pirate_stronghold\",\n        \"factionId\": \"rift_syndicate\",\n        \"danger\": \"high\",\n        \"law\": \"very_low\",\n        \"coords\": { \"x\": -5, \"y\": -3 },\n        \"tags\": [\"pirate\", \"black_market\"],\n        \"connections\": [\"keth_gate\"],\n        \"localModifiers\": {\n          \"events\": {\n            \"piracy\": 2.5,\n            \"smuggling\": 2.0,\n            \"law_enforcement\": 0.1\n          }\n        },\n        \"pointsOfInterest\": [\n          {\n            \"id\": \"black_ring\",\n            \"type\": \"black_market\",\n            \"name\": \"The Black Ring\",\n            \"effects\": {\n              \"blackMarketAccess\": [\"basic_contraband\", \"weapon_upgrades\"]\n            }\n          }\n        ]\n      },\n      {\n        \"id\": \"silent_shroud\",\n        \"name\": \"Silent Shroud\",\n        \"typeId\": \"dead_system\",\n        \"factionId\": null,\n        \"danger\": \"high\",\n        \"law\": \"none\",\n        \"coords\": { \"x\": 6, \"y\": -4 },\n        \"tags\": [\"dead\", \"derelicts\"],\n        \"connections\": [\"keth_gate\"],\n        \"localModifiers\": {\n          \"events\": { \"salvage\": 2.4, \"rare_story\": 1.6 }\n        },\n        \"pointsOfInterest\": [\n          {\n            \"id\": \"derelict_flagship\",\n            \"type\": \"derelict\",\n            \"name\": \"Drifting War Relic\",\n            \"effects\": {\n              \"missionBoard\": [\"derelict_flagship\"]\n            }\n          }\n        ]\n      }\n    ]\n  }\n}", "// src/rng/SeededRng.ts\n// Deterministic xorshift32 RNG wrapper used across systems.\n\nexport interface Rng {\n  seed: number;\n  /**\n   * Returns float in [0, 1).\n   */\n  next(): number;\n  /**\n   * Returns integer in [min, max] inclusive.\n   */\n  int(min: number, max: number): number;\n}\n\nexport function createRng(seed: number): Rng {\n  let state = seed || Date.now();\n\n  const next = () => {\n    // xorshift32\n    state ^= state << 13;\n    state ^= state >>> 17;\n    state ^= state << 5;\n    return (state >>> 0) / 0xffffffff;\n  };\n\n  const int = (min: number, max: number) => {\n    const n = next();\n    return Math.floor(n * (max - min + 1)) + min;\n  };\n\n  return { seed, next, int };\n}\n", "{\n  \"events\": {\n    \"globalWeights\": {\n      \"travel\": 0.45,\n      \"dock\": 0.25,\n      \"idle\": 0.15,\n      \"sleepCycle\": 0.05,\n      \"rare\": 0.01\n    },\n\n    \"categories\": [\n      \"travel\",\n      \"combat\",\n      \"market\",\n      \"mining\",\n      \"smuggling\",\n      \"piracy\",\n      \"law_enforcement\",\n      \"exploration\",\n      \"salvage\",\n      \"crew\",\n      \"ship\",\n      \"rare_story\"\n    ],\n\n    \"roleWeights\": {\n      \"trader\": {\n        \"market\": 2.0,\n        \"piracy\": 1.3,\n        \"law_enforcement\": 1.0,\n        \"combat\": 0.7,\n        \"exploration\": 0.8,\n        \"salvage\": 0.9\n      },\n      \"miner\": {\n        \"mining\": 2.0,\n        \"piracy\": 1.4,\n        \"combat\": 0.9,\n        \"exploration\": 0.6,\n        \"salvage\": 1.3\n      },\n      \"smuggler\": {\n        \"smuggling\": 2.5,\n        \"law_enforcement\": 1.8,\n        \"piracy\": 1.3,\n        \"market\": 0.5,\n        \"combat\": 1.4\n      },\n      \"pirate\": {\n        \"piracy\": 2.3,\n        \"law_enforcement\": 1.8,\n        \"combat\": 1.6,\n        \"trader\": 1.4,\n        \"salvage\": 1.0\n      },\n      \"bounty_hunter\": {\n        \"combat\": 2.2,\n        \"piracy\": 1.2,\n        \"exploration\": 0.8,\n        \"law_enforcement\": 1.3\n      },\n      \"navy\": {\n        \"law_enforcement\": 2.2,\n        \"combat\": 1.6,\n        \"piracy\": 1.2,\n        \"market\": 0.7\n      },\n      \"explorer\": {\n        \"exploration\": 2.4,\n        \"rare_story\": 1.3,\n        \"salvage\": 1.0,\n        \"mining\": 0.8\n      },\n      \"salvager\": {\n        \"salvage\": 2.3,\n        \"combat\": 1.0,\n        \"exploration\": 0.9,\n        \"piracy\": 1.0\n      }\n    },\n\n    \"eventPool\": [\n      {\n        \"id\": \"pirate_ambush\",\n        \"category\": \"piracy\",\n        \"description\": \"A pirate raider decloaks off your bow. They lock weapons and broadcast a demand for tribute.\",\n        \"requirements\": {\n          \"sectorDanger\": \"medium_or_high\"\n        },\n        \"choices\": [\n          {\n            \"id\": \"fight\",\n            \"text\": \"Fight the pirate ship.\",\n            \"tags\": [\"combat\", \"lawful_action\"],\n            \"outcomes\": {\n              \"success\": {\n                \"chance\": 0.55,\n                \"effects\": {\n                  \"damage\": \"medium\",\n                  \"loot\": \"small\",\n                  \"repChanges\": {\n                    \"navy\": 1,\n                    \"pirate\": -2\n                  }\n                }\n              },\n              \"failure\": {\n                \"chance\": 0.45,\n                \"effects\": {\n                  \"damage\": \"heavy\",\n                  \"cargoLossChance\": 0.5\n                }\n              }\n            }\n          },\n          {\n            \"id\": \"pay_tribute\",\n            \"text\": \"Pay tribute and avoid a fight.\",\n            \"tags\": [\"piracy\"],\n            \"outcomes\": {\n              \"success\": {\n                \"chance\": 1.0,\n                \"effects\": {\n                  \"credits\": -250,\n                  \"repChanges\": {\n                    \"pirate\": 1,\n                    \"merchant\": -1\n                  }\n                }\n              }\n            }\n          },\n          {\n            \"id\": \"attempt_escape\",\n            \"text\": \"Try to outrun the pirate.\",\n            \"requirements\": { \"enginePower\": 2 },\n            \"outcomes\": {\n              \"success\": {\n                \"chance\": 0.5,\n                \"effects\": {\n                  \"fuel\": -2\n                }\n              },\n              \"failure\": {\n                \"chance\": 0.5,\n                \"effects\": {\n                  \"damage\": \"light\",\n                  \"cargoLossChance\": 0.2\n                }\n              }\n            }\n          }\n        ]\n      },\n\n      {\n        \"id\": \"pirate_encounter_lane\",\n        \"category\": \"piracy\",\n        \"description\": \"A pirate raider drops out of FTL alongside your lane, weapons hot. They demand payment to 'ensure your continued safety.'\",\n        \"choices\": [\n          {\n            \"id\": \"pay_bribe\",\n            \"text\": \"Pay their bribe and hope they leave.\",\n            \"tags\": [\"piracy\"],\n            \"outcomes\": {\n              \"success\": {\n                \"chance\": 1.0,\n                \"effects\": {\n                  \"credits\": -300,\n                  \"repChanges\": {\n                    \"pirate\": 1,\n                    \"merchant\": -1\n                  },\n                  \"riskAdjust\": {\n                    \"pirateAttention\": -10\n                  }\n                }\n              }\n            }\n          },\n          {\n            \"id\": \"attack_back\",\n            \"text\": \"Power up your weapons and attack.\",\n            \"tags\": [\"combat\", \"lawful_action\"],\n            \"outcomes\": {\n              \"success\": {\n                \"chance\": 0.55,\n                \"effects\": {\n                  \"combat\": \"forced\",\n                  \"repChanges\": {\n                    \"pirate\": -2,\n                    \"navy\": 1\n                  },\n                  \"riskAdjust\": {\n                    \"pirateAttention\": -15\n                  }\n                }\n              },\n              \"failure\": {\n                \"chance\": 0.45,\n                \"effects\": {\n                  \"combat\": \"forced\",\n                  \"flag\": \"enemy_advantage\",\n                  \"riskAdjust\": {\n                    \"pirateAttention\": 5\n                  }\n                }\n              }\n            }\n          },\n          {\n            \"id\": \"alert_police\",\n            \"text\": \"Broadcast a distress call to local authorities (risky).\",\n            \"tags\": [\"lawful_action\"],\n            \"outcomes\": {\n              \"success\": {\n                \"chance\": 0.5,\n                \"effects\": {\n                  \"flag\": \"navy_intervention\",\n                  \"repChanges\": {\n                    \"navy\": 2,\n                    \"pirate\": -1\n                  },\n                  \"riskAdjust\": {\n                    \"pirateAttention\": -20\n                  }\n                }\n              },\n              \"failure\": {\n                \"chance\": 0.5,\n                \"effects\": {\n                  \"flag\": \"pirate_enraged\",\n                  \"repChanges\": {\n                    \"pirate\": 1\n                  },\n                  \"riskAdjust\": {\n                    \"pirateAttention\": 10\n                  }\n                }\n              }\n            }\n          },\n          {\n            \"id\": \"run\",\n            \"text\": \"Push your engines and try to run.\",\n            \"tags\": [\"evasion\", \"flight\"],\n            \"outcomes\": {\n              \"success\": { \"chance\": 1.0, \"effects\": {} }\n            }\n          }\n        ]\n      },\n\n      {\n        \"id\": \"navy_inspection\",\n        \"category\": \"law_enforcement\",\n        \"description\": \"A Navy patrol hails your vessel for a routine inspection.\",\n         \"requirements\": {\n           \"sectorLaw\": \"medium_or_high\"\n         },\n        \"choices\": [\n          {\n            \"id\": \"comply\",\n            \"text\": \"Submit to the inspection.\",\n            \"tags\": [\"lawful_action\"],\n            \"outcomes\": {\n              \"success\": {\n                \"chance\": 1.0,\n                \"effects\": {\n                  \"repChanges\": {\n                    \"navy\": 1\n                  }\n                }\n              }\n            }\n          },\n          {\n            \"id\": \"bribe\",\n            \"text\": \"Attempt to bribe the officer.\",\n            \"tags\": [\"smuggling\"],\n            \"outcomes\": {\n              \"success\": {\n                \"chance\": 0.45,\n                \"effects\": {\n                  \"credits\": -200,\n                  \"repChanges\": {\n                    \"syndicate\": 1\n                  }\n                }\n              },\n              \"failure\": {\n                \"chance\": 0.55,\n                \"effects\": {\n                  \"repChanges\": {\n                    \"navy\": -5\n                  },\n                  \"flag\": \"wanted_status\"\n                }\n              }\n            }\n          },\n          {\n            \"id\": \"flee\",\n            \"text\": \"Attempt to flee the scene.\",\n            \"tags\": [\"piracy\", \"chaos_action\"],\n            \"outcomes\": {\n              \"success\": {\n                \"chance\": 0.35,\n                \"effects\": {\n                  \"fuel\": -3,\n                  \"repChanges\": {\n                    \"navy\": -4\n                  }\n                }\n              },\n              \"failure\": {\n                \"chance\": 0.65,\n                \"effects\": {\n                  \"damage\": \"medium\",\n                  \"combat\": \"forced\"\n                }\n              }\n            }\n          }\n        ]\n      },\n\n      {\n        \"id\": \"rich_asteroid_field\",\n        \"category\": \"mining\",\n        \"description\": \"Scanners pick up a dense asteroid field with high mineral readings.\",\n        \"choices\": [\n          {\n            \"id\": \"mine_safely\",\n            \"text\": \"Mine carefully, minimizing risk.\",\n            \"tags\": [\"mining_support\"],\n            \"outcomes\": {\n              \"success\": {\n                \"chance\": 0.95,\n                \"effects\": {\n                  \"minerals\": \"small\",\n                  \"repChanges\": {\n                    \"miner\": 1\n                  }\n                }\n              }\n            }\n          },\n          {\n            \"id\": \"mine_aggressively\",\n            \"text\": \"Push your mining laser to the limit for maximum yield.\",\n            \"tags\": [\"mining_support\"],\n            \"outcomes\": {\n              \"success\": {\n                \"chance\": 0.60,\n                \"effects\": {\n                  \"minerals\": \"large\"\n                }\n              },\n              \"failure\": {\n                \"chance\": 0.40,\n                \"effects\": {\n                  \"damage\": \"medium\",\n                  \"pirateAttractionChance\": 0.25\n                }\n              }\n            }\n          }\n        ]\n      },\n\n      {\n        \"id\": \"black_market_signal\",\n        \"category\": \"smuggling\",\n        \"description\": \"You detect an encrypted signal offering a smuggler\u2019s contract.\",\n        \"requirements\": {\n          \"syndicateRepMin\": -10\n        },\n        \"choices\": [\n          {\n            \"id\": \"accept\",\n            \"text\": \"Accept the clandestine job.\",\n            \"tags\": [\"smuggling\"],\n            \"outcomes\": {\n              \"success\": {\n                \"chance\": 1.0,\n                \"effects\": {\n                  \"mission_offer\": \"contraband_run\"\n                }\n              }\n            }\n          },\n          {\n            \"id\": \"ignore\",\n            \"text\": \"Ignore the signal.\",\n            \"outcomes\": {\n              \"success\": {\n                \"chance\": 1.0,\n                \"effects\": {}\n              }\n            }\n          }\n        ]\n      },\n\n      {\n        \"id\": \"ancient_beacon\",\n        \"category\": \"rare_story\",\n        \"rarity\": 0.003,\n        \"description\": \"A faint alien beacon pulses across subspace, calling you closer.\",\n        \"choices\": [\n          {\n            \"id\": \"approach\",\n            \"text\": \"Move toward the beacon.\",\n            \"tags\": [\"exploration\"],\n            \"outcomes\": {\n              \"success\": {\n                \"chance\": 0.6,\n                \"effects\": {\n                  \"artifact\": \"unknown\",\n                  \"repChanges\": {\n                    \"researcher\": 3\n                  }\n                }\n              },\n              \"failure\": {\n                \"chance\": 0.4,\n                \"effects\": {\n                  \"damage\": \"medium\"\n                }\n              }\n            }\n          },\n          {\n            \"id\": \"mark_location\",\n            \"text\": \"Record the beacon\u2019s coordinates for later.\",\n            \"outcomes\": {\n              \"success\": {\n                \"chance\": 1.0,\n                \"effects\": {\n                  \"log\": \"beacon_marked\"\n                }\n              }\n            }\n          },\n          {\n            \"id\": \"leave\",\n            \"text\": \"Leave the anomaly alone.\",\n            \"outcomes\": {\n              \"success\": {\n                \"chance\": 1.0,\n                \"effects\": {}\n              }\n            }\n          }\n        ]\n      }\n    ]\n  }\n}\n", "{\n  \"reputationSystem\": {\n    \"globalRange\": {\n      \"min\": -100,\n      \"max\": 100,\n      \"neutral\": 0\n    },\n\n    \"tracks\": [\n      {\n        \"id\": \"merchant\",\n        \"name\": \"Merchant Guilds\",\n        \"description\": \"Represents how trusted you are among traders, corporations, and commercial hubs.\",\n        \"visible\": true,\n        \"effects\": {\n          \"discounts\": [\n            { \"threshold\": 20, \"value\": 0.05 },\n            { \"threshold\": 50, \"value\": 0.10 },\n            { \"threshold\": 80, \"value\": 0.20 }\n          ],\n          \"pricePenalty\": [\n            { \"threshold\": -20, \"value\": 0.05 },\n            { \"threshold\": -50, \"value\": 0.12 },\n            { \"threshold\": -80, \"value\": 0.25 }\n          ],\n          \"eventWeights\": {\n            \"trade_contract_offers\": {\n              \"low\": 0.5,\n              \"mid\": 1.0,\n              \"high\": 1.5\n            }\n          }\n        },\n        \"tiers\": [\n          { \"name\": \"Blacklisted\", \"min\": -100, \"max\": -51 },\n          { \"name\": \"Distrusted\", \"min\": -50, \"max\": -11 },\n          { \"name\": \"Neutral\", \"min\": -10, \"max\": 10 },\n          { \"name\": \"Preferred Partner\", \"min\": 11, \"max\": 49 },\n          { \"name\": \"Key Supplier\", \"min\": 50, \"max\": 79 },\n          { \"name\": \"Guild Icon\", \"min\": 80, \"max\": 100 }\n        ]\n      },\n\n      {\n        \"id\": \"navy\",\n        \"name\": \"Navy / Lawful Authorities\",\n        \"description\": \"Measures your standing with lawful governments, patrols, and official militaries.\",\n        \"visible\": true,\n        \"effects\": {\n          \"patrolBehavior\": {\n            \"hostileThreshold\": -30,\n            \"scanThreshold\": -5,\n            \"escortThreshold\": 50\n          },\n          \"accessLevels\": [\n            {\n              \"threshold\": 20,\n              \"unlocks\": [\"low_security_docks\", \"basic_military_contracts\"]\n            },\n            {\n              \"threshold\": 50,\n              \"unlocks\": [\"restricted_weapons\", \"priority_resupply\"]\n            },\n            {\n              \"threshold\": 80,\n              \"unlocks\": [\"classified_operations\", \"flagship_support\"]\n            }\n          ]\n        },\n        \"tiers\": [\n          { \"name\": \"Enemy of the State\", \"min\": -100, \"max\": -51 },\n          { \"name\": \"Wanted\", \"min\": -50, \"max\": -11 },\n          { \"name\": \"Unregistered\", \"min\": -10, \"max\": 10 },\n          { \"name\": \"Auxiliary\", \"min\": 11, \"max\": 49 },\n          { \"name\": \"Commissioned\", \"min\": 50, \"max\": 79 },\n          { \"name\": \"Decorated Officer\", \"min\": 80, \"max\": 100 }\n        ]\n      },\n\n      {\n        \"id\": \"pirate\",\n        \"name\": \"Pirate Clans\",\n        \"description\": \"Your infamy and respect among raiders, warlords, and criminal fleets.\",\n        \"visible\": true,\n        \"effects\": {\n          \"pirateBehavior\": {\n            \"ignoreThreshold\": 40,\n            \"autoAssistThreshold\": 70\n          },\n          \"raiderEvents\": {\n            \"allyChanceAtHighRep\": 0.25,\n            \"doubleCrossChanceAtLowRep\": 0.35\n          }\n        },\n        \"tiers\": [\n          { \"name\": \"Spineless Merchant\", \"min\": -100, \"max\": -21 },\n          { \"name\": \"Unknown\", \"min\": -20, \"max\": 10 },\n          { \"name\": \"Small-Time Raider\", \"min\": 11, \"max\": 39 },\n          { \"name\": \"Feared Captain\", \"min\": 40, \"max\": 79 },\n          { \"name\": \"Warlord\", \"min\": 80, \"max\": 100 }\n        ]\n      },\n\n      {\n        \"id\": \"syndicate\",\n        \"name\": \"Syndicate / Underworld\",\n        \"description\": \"Your relationship with organized crime, smugglers, and black market brokers.\",\n        \"visible\": true,\n        \"effects\": {\n          \"blackMarketAccess\": [\n            { \"threshold\": 10, \"unlocks\": [\"basic_contraband\"] },\n            { \"threshold\": 40, \"unlocks\": [\"weapon_upgrades\", \"fake_ids\"] },\n            { \"threshold\": 70, \"unlocks\": [\"prototype_tech\", \"ghost_transponder\"] }\n          ],\n          \"betrayalRisk\": [\n            { \"threshold\": -100, \"chance\": 0.40 },\n            { \"threshold\": -50, \"chance\": 0.25 },\n            { \"threshold\": 0, \"chance\": 0.10 }\n          ]\n        },\n        \"tiers\": [\n          { \"name\": \"Police Informant\", \"min\": -100, \"max\": -51 },\n          { \"name\": \"Suspect\", \"min\": -50, \"max\": -11 },\n          { \"name\": \"Unknown\", \"min\": -10, \"max\": 10 },\n          { \"name\": \"Associate\", \"min\": 11, \"max\": 39 },\n          { \"name\": \"Trusted Fixer\", \"min\": 40, \"max\": 79 },\n          { \"name\": \"Shadow Broker\", \"min\": 80, \"max\": 100 }\n        ]\n      },\n\n      {\n        \"id\": \"miner\",\n        \"name\": \"Frontier Miners\",\n        \"description\": \"Rep with mining guilds, frontier clans, and resource cartels.\",\n        \"visible\": true,\n        \"effects\": {\n          \"contractPriority\": [\n            { \"threshold\": 20, \"weightMultiplier\": 1.25 },\n            { \"threshold\": 50, \"weightMultiplier\": 1.6 }\n          ],\n          \"dockFeesReduction\": [\n            { \"threshold\": 30, \"value\": 0.10 }\n          ]\n        },\n        \"tiers\": [\n          { \"name\": \"Claim Jumper\", \"min\": -100, \"max\": -31 },\n          { \"name\": \"Unwelcome\", \"min\": -30, \"max\": -11 },\n          { \"name\": \"Stranger\", \"min\": -10, \"max\": 10 },\n          { \"name\": \"Reliable Hauler\", \"min\": 11, \"max\": 49 },\n          { \"name\": \"Guild Partner\", \"min\": 50, \"max\": 79 },\n          { \"name\": \"Legend of the Belt\", \"min\": 80, \"max\": 100 }\n        ]\n      },\n\n      {\n        \"id\": \"researcher\",\n        \"name\": \"Scientific Community\",\n        \"description\": \"Rep with research labs, xenologists, and anomaly study groups.\",\n        \"visible\": true,\n        \"effects\": {\n          \"dataPayoutMultiplier\": [\n            { \"threshold\": 20, \"value\": 1.15 },\n            { \"threshold\": 50, \"value\": 1.35 },\n            { \"threshold\": 80, \"value\": 1.70 }\n          ],\n          \"specialProjectsChance\": [\n            { \"threshold\": 40, \"chance\": 0.15 },\n            { \"threshold\": 70, \"chance\": 0.30 }\n          ]\n        },\n        \"tiers\": [\n          { \"name\": \"Crank\", \"min\": -100, \"max\": -31 },\n          { \"name\": \"Discredited\", \"min\": -30, \"max\": -11 },\n          { \"name\": \"Independent\", \"min\": -10, \"max\": 10 },\n          { \"name\": \"Field Contributor\", \"min\": 11, \"max\": 49 },\n          { \"name\": \"Recognized Expert\", \"min\": 50, \"max\": 79 },\n          { \"name\": \"Pioneer of the Unknown\", \"min\": 80, \"max\": 100 }\n        ]\n      }\n    ],\n\n    \"alignmentTracks\": [\n      {\n        \"id\": \"law\",\n        \"name\": \"Law\",\n        \"description\": \"Tendency to support order, governments, and official structures.\",\n        \"hidden\": false,\n        \"range\": { \"min\": 0, \"max\": 100 },\n        \"effects\": {\n          \"lawfulMissionAccessThreshold\": 40,\n          \"smugglerPenaltyThreshold\": 60\n        }\n      },\n      {\n        \"id\": \"chaos\",\n        \"name\": \"Chaos\",\n        \"description\": \"Tendency to support piracy, sabotage, and destabilizing forces.\",\n        \"hidden\": false,\n        \"range\": { \"min\": 0, \"max\": 100 },\n        \"effects\": {\n          \"pirateEventBoostThreshold\": 40,\n          \"navyAggroThreshold\": 60\n        }\n      }\n    ],\n\n    \"changeRules\": {\n      \"decay\": {\n        \"enabled\": true,\n        \"perTurn\": 0,\n        \"perJump\": 0,\n        \"perDay\": 0.1,\n        \"towardNeutralOnly\": true\n      },\n      \"hardLocks\": [\n        {\n          \"condition\": \"navy <= -80\",\n          \"effects\": [\"no_navy_contracts\", \"navy_shoot_on_sight\"]\n        },\n        {\n          \"condition\": \"pirate >= 80 && law >= 60\",\n          \"effects\": [\"internal_conflict_events\"]\n        }\n      ],\n\n      \"roleTags\": [\n        {\n          \"tag\": \"lawful_action\",\n          \"reputationDeltas\": {\n            \"navy\": 2,\n            \"pirate\": -1,\n            \"syndicate\": -1\n          },\n          \"alignmentDeltas\": {\n            \"law\": 2,\n            \"chaos\": -1\n          }\n        },\n        {\n          \"tag\": \"piracy\",\n          \"reputationDeltas\": {\n            \"navy\": -4,\n            \"merchant\": -2,\n            \"pirate\": 3,\n            \"syndicate\": 1\n          },\n          \"alignmentDeltas\": {\n            \"law\": -3,\n            \"chaos\": 3\n          }\n        },\n        {\n          \"tag\": \"smuggling\",\n          \"reputationDeltas\": {\n            \"navy\": -3,\n            \"merchant\": -1,\n            \"syndicate\": 3\n          },\n          \"alignmentDeltas\": {\n            \"law\": -2,\n            \"chaos\": 2\n          }\n        },\n        {\n          \"tag\": \"trade_support\",\n          \"reputationDeltas\": {\n            \"merchant\": 2\n          },\n          \"alignmentDeltas\": {}\n        },\n        {\n          \"tag\": \"mining_support\",\n          \"reputationDeltas\": {\n            \"miner\": 2,\n            \"merchant\": 1\n          },\n          \"alignmentDeltas\": {}\n        },\n        {\n          \"tag\": \"research_support\",\n          \"reputationDeltas\": {\n            \"researcher\": 3\n          },\n          \"alignmentDeltas\": {}\n        }\n      ]\n    }\n  }\n}", "// src/systems/PlayerState.ts\n// Player and ship state helpers. All values are deterministic and capped safely.\n\nimport { GameState, PlayerState, RoleId, ReputationMap } from \"../game/GameState\";\nimport reputationEngine from \"../../reputation_engine.json\";\nimport { Galaxy } from \"../../galaxyTypes\";\n\ninterface NewPlayerOptions {\n  name: string;\n  roleId: RoleId;\n  startingCredits?: number;\n  startingFuel?: number;\n}\n\nconst STARTING_SHIP: Omit<PlayerState, \"name\" | \"roleId\" | \"reputation\" | \"credits\" | \"fuel\" | \"maxFuel\"> = {\n  ship: {\n    hull: 100,\n    maxHull: 100,\n    shields: 50,\n    maxShields: 50,\n    fuel: 0,\n    maxFuel: 0,\n    evasion: 10,\n    sensorStrength: 10,\n    enginePower: 10,\n    mass: 8,\n    agility: 6,\n    pilotSkill: 2,\n    weaponDamage: 10,\n    cargoCapacity: 20\n  },\n  modules: {\n    engines: [\"basic_thrusters\"],\n    scanners: [\"short_range_scanner\"],\n    weapons: [\"civilian_lasers\"],\n    utilities: []\n  },\n  cargo: [],\n  inventory: [],\n  crew: [],\n  statuses: [],\n  risk: {\n    pirateAttention: 0\n  }\n};\n\nexport function createPlayerState(\n  galaxy: Galaxy,\n  options: NewPlayerOptions\n): PlayerState {\n  const reputation = seedReputation(galaxy, 0);\n  const fuel = options.startingFuel ?? 10;\n  const maxFuel = 15;\n  return {\n    name: options.name,\n    roleId: options.roleId,\n    credits: options.startingCredits ?? 500,\n    fuel,\n    maxFuel,\n    ...STARTING_SHIP,\n    reputation,\n    ship: {\n      ...STARTING_SHIP.ship,\n      fuel,\n      maxFuel\n    }\n  };\n}\n\nexport function seedReputation(\n  galaxy: Galaxy,\n  baseline: number\n): ReputationMap {\n  const rep: ReputationMap = {};\n  for (const faction of galaxy.factions || []) rep[faction.id] = baseline;\n  const tracks = (reputationEngine as { reputationSystem: { tracks: { id: string }[] } }).reputationSystem.tracks;\n  for (const track of tracks) rep[track.id] = baseline;\n  return rep;\n}\n\nexport function adjustCredits(player: PlayerState, delta: number): void {\n  player.credits = Math.max(0, player.credits + delta);\n}\n\nexport function adjustFuel(player: PlayerState, delta: number): void {\n  const newFuel = Math.max(0, Math.min(player.maxFuel, player.fuel + delta));\n  player.fuel = newFuel;\n  player.ship.fuel = Math.min(player.ship.maxFuel, newFuel);\n}\n\nexport function applyDamage(player: PlayerState, severity: \"light\" | \"medium\" | \"heavy\"): void {\n  const map = { light: 10, medium: 25, heavy: 40 };\n  const dmg = map[severity] ?? 0;\n  const preShield = player.ship.shields;\n  player.ship.shields = Math.max(0, preShield - dmg);\n  const spill = Math.max(0, dmg - preShield);\n  player.ship.hull = Math.max(0, player.ship.hull - spill);\n}\n\nexport function repairHull(player: PlayerState, amount: number): void {\n  player.ship.hull = Math.min(player.ship.maxHull, player.ship.hull + amount);\n}\n\nexport function adjustReputation(\n  player: PlayerState,\n  delta: Record<string, number>\n): void {\n  for (const k of Object.keys(delta)) {\n    if (!(k in player.reputation)) continue;\n    player.reputation[k] += delta[k];\n  }\n}\n\nexport function addStatus(player: PlayerState, status: string): void {\n  if (!player.statuses.includes(status)) player.statuses.push(status);\n}\n\nexport function addCargo(\n  player: PlayerState,\n  item: { commodityId: string; quantity: number }\n): boolean {\n  const used = player.cargo.reduce((sum, c) => sum + c.quantity, 0);\n  if (used + item.quantity > player.ship.cargoCapacity) return false;\n  const existing = player.cargo.find((c) => c.commodityId === item.commodityId);\n  if (existing) existing.quantity += item.quantity;\n  else player.cargo.push({ ...item });\n  return true;\n}\n\nexport function removeCargo(\n  player: PlayerState,\n  commodityId: string,\n  quantity: number\n): boolean {\n  const existing = player.cargo.find((c) => c.commodityId === commodityId);\n  if (!existing || existing.quantity < quantity) return false;\n  existing.quantity -= quantity;\n  if (existing.quantity === 0) {\n    player.cargo = player.cargo.filter((c) => c.commodityId !== commodityId);\n  }\n  return true;\n}\n\nexport function removeRandomCargo(player: PlayerState, rng: () => number): void {\n  if (!player.cargo.length) return;\n  const idx = Math.floor(rng() * player.cargo.length);\n  const target = player.cargo[idx];\n  if (target.quantity > 1) target.quantity -= 1;\n  else player.cargo.splice(idx, 1);\n}\n\nexport function appendLog(game: GameState, message: string, data?: Record<string, unknown>): void {\n  game.log.push({\n    cycle: game.time.cycle,\n    sectorId: game.currentSectorId,\n    message,\n    data\n  });\n}\n", "{\n  \"careers\": [\n    {\n      \"id\": \"trader\",\n      \"name\": \"Trader\",\n      \"description\": \"Buy low, sell high. Manipulate markets, move goods, and build commercial influence.\",\n      \"coreStats\": {\n        \"relevant\": [\"merchantSkill\", \"sensorStrength\", \"cargoSpace\"],\n        \"riskStats\": [\"evasion\", \"shieldStrength\"]\n      },\n      \"actions\": [\n        \"buy_goods\",\n        \"sell_goods\",\n        \"take_trade_contract\",\n        \"check_market_trends\",\n        \"negotiate_prices\"\n      ],\n      \"missions\": [\n        {\n          \"id\": \"contract_delivery\",\n          \"name\": \"Delivery Contract\",\n          \"description\": \"Deliver goods to another system within a time limit.\",\n          \"riskLevel\": \"low\",\n          \"baseReward\": 350,\n          \"reputationEffects\": {\n            \"merchant\": 2,\n            \"navy\": 0,\n            \"pirate\": -1,\n            \"syndicate\": 0,\n            \"miner\": 0,\n            \"researcher\": 0\n          }\n        },\n        {\n          \"id\": \"speculation_run\",\n          \"name\": \"Speculation Run\",\n          \"description\": \"Buy a trending commodity and sell it before the price crashes.\",\n          \"riskLevel\": \"medium\",\n          \"baseReward\": 0,\n          \"dynamicReward\": \"market_surge_multiplier\"\n        }\n      ],\n      \"illegal\": false,\n      \"alignment\": \"neutral\"\n    },\n\n    {\n      \"id\": \"miner\",\n      \"name\": \"Miner\",\n      \"description\": \"Extract resources from asteroids, gas giants, ruins, and anomalies.\",\n      \"coreStats\": {\n        \"relevant\": [\"miningYield\", \"enginePower\", \"sensorStrength\"],\n        \"riskStats\": [\"shieldStrength\", \"repairRate\"]\n      },\n      \"actions\": [\n        \"mine_asteroids\",\n        \"deploy_drones\",\n        \"harvest_gas\",\n        \"survey_rich_fields\"\n      ],\n      \"missions\": [\n        {\n          \"id\": \"mining_contract\",\n          \"name\": \"Mining Contract\",\n          \"description\": \"Mine specific minerals for a faction.\",\n          \"riskLevel\": \"low\",\n          \"baseReward\": 200,\n          \"reputationEffects\": {\n            \"merchant\": 0,\n            \"navy\": 0,\n            \"pirate\": 0,\n            \"syndicate\": 0,\n            \"miner\": 3,\n            \"researcher\": 0\n          }\n        },\n        {\n          \"id\": \"deep_core_mining\",\n          \"name\": \"Deep-Core Extraction\",\n          \"description\": \"Risky mining of rare minerals in a dangerous zone.\",\n          \"riskLevel\": \"high\",\n          \"baseReward\": 700,\n          \"dangerModifiers\": [\"radiation\", \"unstable_rocks\"]\n        }\n      ],\n      \"illegal\": false,\n      \"alignment\": \"neutral\"\n    },\n\n    {\n      \"id\": \"smuggler\",\n      \"name\": \"Smuggler\",\n      \"description\": \"Run illegal goods past law enforcement, use stealth, and make massive profit with high risk.\",\n      \"coreStats\": {\n        \"relevant\": [\"stealth\", \"evasion\", \"merchantSkill\"],\n        \"riskStats\": [\"shieldStrength\", \"morale\"]\n      },\n      \"actions\": [\n        \"run_blockade\",\n        \"bribe_official\",\n        \"hide_cargo\",\n        \"enter_black_market\"\n      ],\n      \"missions\": [\n        {\n          \"id\": \"contraband_run\",\n          \"name\": \"Contraband Run\",\n          \"description\": \"Deliver illegal goods to a black market.\",\n          \"riskLevel\": \"high\",\n          \"baseReward\": 1200,\n          \"reputationEffects\": {\n            \"merchant\": -1,\n            \"navy\": -4,\n            \"pirate\": 3,\n            \"syndicate\": 4,\n            \"miner\": 0,\n            \"researcher\": 0\n          }\n        },\n        {\n          \"id\": \"undercover_delivery\",\n          \"name\": \"Undercover Drop\",\n          \"description\": \"Deliver encrypted package to a Syndicate contact.\",\n          \"riskLevel\": \"medium\",\n          \"baseReward\": 700\n        }\n      ],\n      \"illegal\": true,\n      \"alignment\": \"chaos\"\n    },\n\n    {\n      \"id\": \"pirate\",\n      \"name\": \"Pirate\",\n      \"description\": \"Attack civilian ships, steal cargo, demand tribute, and carve out a violent life.\",\n      \"coreStats\": {\n        \"relevant\": [\"weaponDamage\", \"boardingSkill\", \"intimidation\"],\n        \"riskStats\": [\"hullIntegrity\", \"shieldStrength\"]\n      },\n      \"actions\": [\n        \"scan_for_targets\",\n        \"ambush_trader\",\n        \"board_ship\",\n        \"demand_tribute\"\n      ],\n      \"missions\": [\n        {\n          \"id\": \"raid_caravan\",\n          \"name\": \"Raid Supply Caravan\",\n          \"description\": \"Ambush a merchant convoy.\",\n          \"riskLevel\": \"high\",\n          \"baseReward\": \"loot_based\",\n          \"dangerModifiers\": [\"navy_response\"]\n        },\n        {\n          \"id\": \"intimidation_run\",\n          \"name\": \"Tribute Demand\",\n          \"description\": \"Force a small ship to surrender goods.\",\n          \"riskLevel\": \"low\",\n          \"baseReward\": 150\n        }\n      ],\n      \"illegal\": true,\n      \"alignment\": \"chaos\"\n    },\n\n    {\n      \"id\": \"bounty_hunter\",\n      \"name\": \"Bounty Hunter\",\n      \"description\": \"Hunt criminals, track fugitives, and bring targets in dead or alive.\",\n      \"coreStats\": {\n        \"relevant\": [\"weaponDamage\", \"sensorStrength\", \"enginePower\"],\n        \"riskStats\": [\"hullIntegrity\", \"repairRate\"]\n      },\n      \"actions\": [\n        \"check_bounty_board\",\n        \"track_target\",\n        \"engage_criminal\",\n        \"bring_in_target\"\n      ],\n      \"missions\": [\n        {\n          \"id\": \"low_value_bounty\",\n          \"name\": \"Low-Value Target\",\n          \"description\": \"Capture a small-time smuggler.\",\n          \"riskLevel\": \"low\",\n          \"baseReward\": 200,\n          \"reputationEffects\": {\n            \"navy\": 2,\n            \"merchant\": 1,\n            \"pirate\": -2\n          }\n        },\n        {\n          \"id\": \"high_value_fugitive\",\n          \"name\": \"High-Value Fugitive\",\n          \"description\": \"Track and eliminate a dangerous war criminal.\",\n          \"riskLevel\": \"very_high\",\n          \"baseReward\": 1200,\n          \"dangerModifiers\": [\"target_ship_upgrades\", \"escape_attempts\"]\n        }\n      ],\n      \"illegal\": false,\n      \"alignment\": \"law\"\n    },\n\n    {\n      \"id\": \"navy\",\n      \"name\": \"Navy Officer\",\n      \"description\": \"Serve the government, patrol borders, escort fleets, and uphold the law.\",\n      \"coreStats\": {\n        \"relevant\": [\"weaponDamage\", \"shieldStrength\", \"enginePower\"],\n        \"riskStats\": [\"hullIntegrity\", \"morale\"]\n      },\n      \"actions\": [\n        \"patrol_sector\",\n        \"inspect_ship\",\n        \"escort_convoy\",\n        \"fight_pirates\"\n      ],\n      \"missions\": [\n        {\n          \"id\": \"sector_patrol\",\n          \"name\": \"Sector Patrol\",\n          \"description\": \"Scan ships and enforce the law.\",\n          \"riskLevel\": \"medium\",\n          \"baseReward\": 300,\n          \"reputationEffects\": {\n            \"navy\": 3,\n            \"merchant\": 1,\n            \"pirate\": -3\n          }\n        },\n        {\n          \"id\": \"frontline_conflict\",\n          \"name\": \"Frontline Conflict\",\n          \"description\": \"Join a battle in a contested sector.\",\n          \"riskLevel\": \"very_high\",\n          \"baseReward\": 800\n        }\n      ],\n      \"illegal\": false,\n      \"alignment\": \"law\"\n    },\n\n    {\n      \"id\": \"explorer\",\n      \"name\": \"Explorer\",\n      \"description\": \"Chart the unknown, study anomalies, and uncover ancient ruins.\",\n      \"coreStats\": {\n        \"relevant\": [\"sensorStrength\", \"scienceSkill\", \"enginePower\"],\n        \"riskStats\": [\"hullIntegrity\", \"repairRate\"]\n      },\n      \"actions\": [\n        \"scan_anomaly\",\n        \"chart_sector\",\n        \"investigate_signal\",\n        \"study_ruin\"\n      ],\n      \"missions\": [\n        {\n          \"id\": \"scan_wormhole\",\n          \"name\": \"Wormhole Survey\",\n          \"description\": \"Analyze a newly opened wormhole.\",\n          \"riskLevel\": \"high\",\n          \"baseReward\": 500,\n          \"reputationEffects\": {\n            \"researcher\": 4\n          }\n        },\n        {\n          \"id\": \"ancient_ruin\",\n          \"name\": \"Ancient Ruin Dive\",\n          \"description\": \"Explore the remnants of a lost civilization.\",\n          \"riskLevel\": \"very_high\",\n          \"baseReward\": 1000,\n          \"rareFindChance\": 0.2\n        }\n      ],\n      \"illegal\": false,\n      \"alignment\": \"neutral\"\n    },\n\n    {\n      \"id\": \"salvager\",\n      \"name\": \"Salvager\",\n      \"description\": \"Scour the galaxy for derelicts, wrecks, and hidden tech.\",\n      \"coreStats\": {\n        \"relevant\": [\"tractorBeamPower\", \"sensorStrength\", \"repairRate\"],\n        \"riskStats\": [\"hullIntegrity\"]\n      },\n      \"actions\": [\n        \"scan_for_wrecks\",\n        \"board_derelict\",\n        \"salvage_components\",\n        \"tow_ship\"\n      ],\n      \"missions\": [\n        {\n          \"id\": \"wreck_salvage\",\n          \"name\": \"Wreck Salvage\",\n          \"description\": \"Strip components from a destroyed freighter.\",\n          \"riskLevel\": \"medium\",\n          \"baseReward\": 350\n        },\n        {\n          \"id\": \"derelict_flagship\",\n          \"name\": \"Derelict Flagship\",\n          \"description\": \"Explore a massive drifting warship.\",\n          \"riskLevel\": \"very_high\",\n          \"baseReward\": 900,\n          \"hazards\": [\"rogue_ai\", \"electrical_arcs\", \"unstable_hull\"]\n        }\n      ],\n      \"illegal\": false,\n      \"alignment\": \"neutral\"\n    }\n  ]\n}", "// src/systems/MissionSystem.ts\n// Mission offers and lifecycle driven by career_system.json.\n\nimport careerSystem from \"../../career_system.json\";\nimport { GameState, MissionDefinition, MissionInstance, MissionRiskLevel, RoleId } from \"../game/GameState\";\nimport { adjustCredits, adjustReputation, appendLog } from \"./PlayerState\";\nimport { Rng } from \"../rng/SeededRng\";\n\ninterface CareerDefinition {\n  id: RoleId | string;\n  missions: MissionDefinition[];\n}\n\ninterface CareerSystemConfig {\n  careers: CareerDefinition[];\n}\n\nconst CAREER_DATA = careerSystem as unknown as CareerSystemConfig;\n\nconst MISSION_CONFIG = {\n  durationByRisk: {\n    low: 6,\n    medium: 10,\n    high: 14,\n    very_high: 18\n  } satisfies Record<MissionRiskLevel, number>,\n  lootBasedReward: 450,\n  dynamicRewardBase: {\n    market_surge_multiplier: 400\n  } as Record<string, number>,\n  riskRewardMultiplier: {\n    low: 1,\n    medium: 1.2,\n    high: 1.5,\n    very_high: 1.8\n  } satisfies Record<MissionRiskLevel, number>\n};\n\nexport function getMissionDefinition(missionId: string): { definition: MissionDefinition; careerId: RoleId | string } | null {\n  for (const career of CAREER_DATA.careers) {\n    const found = career.missions.find((m) => m.id === missionId);\n    if (found) return { definition: found, careerId: career.id };\n  }\n  return null;\n}\n\nexport function createMissionOffer(\n  game: GameState,\n  missionId: string,\n  sectorId: string | undefined,\n  rng: Rng,\n  autoAccept = true\n): MissionInstance | null {\n  const found = getMissionDefinition(missionId);\n  if (!found) return null;\n  const { definition, careerId } = found;\n  const reward = calculateReward(definition);\n  const instance: MissionInstance = {\n    instanceId: `${missionId}_${Math.floor(rng.next() * 1_000_000)}`,\n    missionId,\n    careerId,\n    sectorId,\n    status: autoAccept ? \"accepted\" : \"offered\",\n    expiresIn: MISSION_CONFIG.durationByRisk[definition.riskLevel],\n    reward,\n    reputationEffects: definition.reputationEffects,\n    notes: []\n  };\n  game.activeMissions.push(instance);\n  appendLog(game, `Mission ${autoAccept ? \"accepted\" : \"offered\"}: ${definition.name}`, {\n    missionId,\n    reward,\n    expiresIn: instance.expiresIn\n  });\n  return instance;\n}\n\nexport function acceptMission(game: GameState, instanceId: string): MissionInstance | null {\n  const mission = game.activeMissions.find((m) => m.instanceId === instanceId);\n  if (!mission) return null;\n  mission.status = \"accepted\";\n  appendLog(game, `Accepted mission ${mission.missionId}`, { instanceId });\n  return mission;\n}\n\nexport function completeMission(game: GameState, instanceId: string): MissionInstance | null {\n  const idx = game.activeMissions.findIndex((m) => m.instanceId === instanceId);\n  if (idx === -1) return null;\n  const mission = game.activeMissions[idx];\n  game.activeMissions.splice(idx, 1);\n  mission.status = \"completed\";\n  game.completedMissions.push(mission);\n  adjustCredits(game.player, mission.reward);\n  if (mission.reputationEffects) {\n    adjustReputation(game.player, mission.reputationEffects);\n  }\n  appendLog(game, `Completed mission ${mission.missionId}`, {\n    instanceId,\n    reward: mission.reward\n  });\n  return mission;\n}\n\nexport function failMission(game: GameState, instanceId: string, reason: string): MissionInstance | null {\n  const idx = game.activeMissions.findIndex((m) => m.instanceId === instanceId);\n  if (idx === -1) return null;\n  const mission = game.activeMissions[idx];\n  game.activeMissions.splice(idx, 1);\n  mission.status = \"failed\";\n  game.failedMissions.push(mission);\n  appendLog(game, `Mission failed: ${mission.missionId}`, { reason, instanceId });\n  return mission;\n}\n\nexport function tickMissions(game: GameState): void {\n  for (const mission of game.activeMissions) {\n    if (typeof mission.expiresIn === \"number\") {\n      mission.expiresIn = Math.max(0, mission.expiresIn - 1);\n    }\n  }\n  const expired = game.activeMissions.filter((m) => m.expiresIn === 0);\n  for (const mission of expired) {\n    failMission(game, mission.instanceId, \"expired\");\n  }\n}\n\nfunction calculateReward(definition: MissionDefinition): number {\n  let reward = 0;\n  if (typeof definition.baseReward === \"number\") {\n    reward = definition.baseReward;\n  } else if (definition.baseReward === \"loot_based\") {\n    reward = MISSION_CONFIG.lootBasedReward;\n  }\n  if (definition.dynamicReward) {\n    const extra = MISSION_CONFIG.dynamicRewardBase[definition.dynamicReward] ?? 0;\n    reward += extra;\n  }\n  const riskMultiplier = MISSION_CONFIG.riskRewardMultiplier[definition.riskLevel] ?? 1;\n  return Math.round(reward * riskMultiplier);\n}\n", "// src/systems/RiskSystem.ts\n// Risk accumulation and pirate encounter chances.\n\nimport { PlayerState, GameState } from \"../game/GameState\";\nimport { Sector } from \"../../galaxyTypes\";\n\nexport type MiningMode = \"safe\" | \"aggressive\";\n\nexport function applyMiningRisk(player: PlayerState, sector: Sector, mode: MiningMode): void {\n  const base = mode === \"safe\" ? 3 : 7;\n  const dangerMod = sector.danger === \"high\" ? 2 : sector.danger === \"medium\" ? 1.3 : 1;\n  player.risk.pirateAttention = Math.min(100, player.risk.pirateAttention + base * dangerMod);\n}\n\nexport function applyTravelRisk(player: PlayerState, sector: Sector): void {\n  const travelBump = sector.danger === \"high\" ? 4 : sector.danger === \"medium\" ? 2 : 1;\n  player.risk.pirateAttention = Math.min(100, player.risk.pirateAttention + travelBump);\n}\n\nexport function pirateEncounterChance(player: PlayerState, sector: Sector): number {\n  const base =\n    sector.danger === \"high\" ? 0.25 : sector.danger === \"medium\" ? 0.15 : 0.05;\n  const riskBonus = player.risk.pirateAttention / 200; // up to +0.5 at 100\n  return Math.min(0.9, base + riskBonus);\n}\n\nexport function decayPirateAttention(player: PlayerState, amount: number): void {\n  player.risk.pirateAttention = Math.max(0, player.risk.pirateAttention - amount);\n}\n", "// src/systems/math.ts\nexport function clamp(min: number, max: number, v: number): number {\n  return Math.max(min, Math.min(max, v));\n}\n", "// src/systems/EscapeSystem.ts\n// Calculates flee chance and resolves run attempts during pirate encounters.\n\nimport { ShipStats } from \"../game/GameState\";\nimport { DangerLevel } from \"../../galaxyTypes\";\nimport { clamp } from \"./math\";\n\nexport interface FleeContext {\n  playerShip: ShipStats;\n  enemySpeedRating: number; // 1-10\n  sectorDanger: DangerLevel;\n  pirateAttention: number; // 0-100\n}\n\nexport function calculateFleeChance(ctx: FleeContext): number {\n  const { playerShip, enemySpeedRating, sectorDanger, pirateAttention } = ctx;\n  const engine = playerShip.enginePower;\n  const agility = playerShip.agility;\n  const mass = playerShip.mass;\n  const pilot = playerShip.pilotSkill ?? 0;\n\n  const speedScore = (engine + agility * 0.7 + pilot * 0.5) / Math.max(1, mass);\n  const enemyScore = enemySpeedRating;\n  let base = 0.5 + (speedScore - enemyScore) * 0.05;\n\n  const hullRatio = playerShip.hull / Math.max(1, playerShip.maxHull);\n  const damagePenalty = (1 - hullRatio) * 0.2;\n  const dangerPenalty =\n    sectorDanger === \"high\" ? 0.15 : sectorDanger === \"medium\" ? 0.07 : 0;\n  const riskPenalty = (pirateAttention / 100) * 0.15;\n\n  return clamp(0.1, 0.9, base - damagePenalty - dangerPenalty - riskPenalty);\n}\n", "// src/systems/EventEngine.ts\n// Deterministic event selection and resolution based on event_system.json weights.\n\nimport eventSystem from \"../../event_system.json\";\nimport { Galaxy, Sector } from \"../../galaxyTypes\";\nimport { GameState, EventSelection, PlayerState } from \"../game/GameState\";\nimport { adjustCredits, adjustFuel, adjustReputation, addStatus, applyDamage, removeRandomCargo } from \"./PlayerState\";\nimport { createMissionOffer } from \"./MissionSystem\";\nimport { decayPirateAttention } from \"./RiskSystem\";\nimport { calculateFleeChance } from \"./EscapeSystem\";\nimport { Rng } from \"../rng/SeededRng\";\n\ntype EventCategory = (typeof eventSystem.events.categories)[number];\n\ninterface EventRequirement {\n  sectorDanger?: \"medium_or_high\";\n  sectorLaw?: \"medium_or_high\";\n  enginePower?: number;\n  syndicateRepMin?: number;\n}\n\ninterface EventEffect {\n  credits?: number;\n  fuel?: number;\n  damage?: \"light\" | \"medium\" | \"heavy\";\n  cargoLossChance?: number;\n  repChanges?: Record<string, number>;\n  loot?: \"small\" | \"medium\" | \"large\";\n  minerals?: \"small\" | \"large\";\n  artifact?: string;\n  mission_offer?: string;\n  flag?: string;\n  combat?: \"forced\";\n  log?: string;\n  riskAdjust?: {\n    pirateAttention?: number;\n  };\n}\n\ninterface OutcomeBranch {\n  chance: number;\n  effects: EventEffect;\n}\n\ninterface EventChoice {\n  id: string;\n  text: string;\n  tags?: string[];\n  requirements?: EventRequirement;\n  outcomes: {\n    success: OutcomeBranch;\n    failure?: OutcomeBranch;\n  };\n}\n\ninterface EventDefinition {\n  id: string;\n  category: EventCategory;\n  description: string;\n  rarity?: number;\n  requirements?: EventRequirement;\n  choices: EventChoice[];\n}\n\ninterface EventConfig {\n  globalWeights: Record<EventCategory, number>;\n  roleWeights: Record<string, Record<EventCategory, number>>;\n  eventPool: EventDefinition[];\n}\n\nconst config: EventConfig = eventSystem.events as unknown as EventConfig;\n\nconst EFFECT_CONFIG = {\n  lootCredits: { small: 200, medium: 400, large: 800 },\n  mineralsYield: { small: 3, large: 6 }\n};\n\nexport class EventEngine {\n  constructor(private galaxy: Galaxy) {}\n\n  rollEvent(game: GameState, sector: Sector, rng: Rng, choiceId?: string): EventSelection | null {\n    const pool = this.filterEligibleEvents(game, sector);\n    if (!pool.length) return null;\n    const picked = this.weightedPick(pool, game.player, sector, rng);\n    if (!picked) return null;\n\n    const choice = this.pickChoice(picked, game.player, rng, choiceId);\n    if (!choice) return null;\n\n    const handled = this.handleRunIfNeeded(picked, choice, game, sector, rng);\n    if (handled) return handled;\n\n    const outcomeType = this.pickOutcomeBranch(choice, rng);\n    const branch = choice.outcomes[outcomeType];\n    if (!branch) return null;\n\n    this.applyEffects(game, branch.effects, rng);\n\n    return {\n      eventId: picked.id,\n      category: picked.category,\n      description: picked.description,\n      choiceId: choice.id,\n      outcome: outcomeType,\n      delta: branch.effects as Record<string, unknown>\n    };\n  }\n\n  rollSpecificEvent(game: GameState, eventId: string, sector: Sector, rng: Rng, choiceId?: string): EventSelection | null {\n    const evt = (config.eventPool as EventDefinition[]).find((e) => e.id === eventId);\n    if (!evt || !this.meetsRequirements(evt.requirements, game, sector)) return null;\n    const choice = this.pickChoice(evt, game.player, rng, choiceId);\n    if (!choice) return null;\n    const handled = this.handleRunIfNeeded(evt, choice, game, sector, rng);\n    if (handled) return handled;\n    const outcomeType = this.pickOutcomeBranch(choice, rng);\n    const branch = choice.outcomes[outcomeType];\n    if (!branch) return null;\n    this.applyEffects(game, branch.effects, rng);\n    return {\n      eventId: evt.id,\n      category: evt.category,\n      description: evt.description,\n      choiceId: choice.id,\n      outcome: outcomeType,\n      delta: branch.effects as Record<string, unknown>\n    };\n  }\n\n  private filterEligibleEvents(game: GameState, sector: Sector): EventDefinition[] {\n    return config.eventPool.filter((evt) => this.meetsRequirements(evt.requirements, game, sector));\n  }\n\n  private meetsRequirements(req: EventRequirement | undefined, game: GameState, sector: Sector | null): boolean {\n    if (!req) return true;\n    if (sector && req.sectorDanger === \"medium_or_high\" && !(sector.danger === \"medium\" || sector.danger === \"high\")) {\n      return false;\n    }\n    if (sector && req.sectorLaw === \"medium_or_high\" && !(sector.law === \"medium\" || sector.law === \"high\")) {\n      return false;\n    }\n    if (typeof req.enginePower === \"number\" && game.player.ship.enginePower < req.enginePower) {\n      return false;\n    }\n    if (typeof req.syndicateRepMin === \"number\" && (game.player.reputation[\"syndicate\"] ?? 0) < req.syndicateRepMin) {\n      return false;\n    }\n    return true;\n  }\n\n  private weightedPick(events: EventDefinition[], player: PlayerState, sector: Sector, rng: Rng): EventDefinition | null {\n    const weights = events.map((evt) => this.computeWeight(evt, player, sector));\n    const total = weights.reduce((a, b) => a + b, 0);\n    if (total <= 0) return null;\n    let roll = rng.next() * total;\n    for (let i = 0; i < events.length; i++) {\n      roll -= weights[i];\n      if (roll <= 0) return events[i];\n    }\n    return events[events.length - 1];\n  }\n\n  private computeWeight(evt: EventDefinition, player: PlayerState, sector: Sector): number {\n    const base = config.globalWeights[evt.category] ?? 1;\n    const roleWeight = config.roleWeights[player.roleId]?.[evt.category] ?? 1;\n    const sectorMod = sector.localModifiers?.events?.[evt.category] ?? 1;\n    const rarityMod = evt.rarity ? 1 / evt.rarity : 1;\n    return base * roleWeight * sectorMod * rarityMod;\n  }\n\n  private handleRunIfNeeded(\n    evt: EventDefinition,\n    choice: EventChoice,\n    game: GameState,\n    sector: Sector,\n    rng: Rng\n  ): EventSelection | null {\n    if (evt.id !== \"pirate_encounter_lane\" || choice.id !== \"run\") return null;\n    const fleeChance = calculateFleeChance({\n      playerShip: game.player.ship,\n      enemySpeedRating: 7,\n      sectorDanger: sector.danger,\n      pirateAttention: game.player.risk.pirateAttention\n    });\n    const roll = rng.next();\n    const success = roll < fleeChance;\n    if (success) {\n      game.player.ship.fuel = Math.max(0, game.player.ship.fuel - 1);\n      decayPirateAttention(game.player, 15);\n      this.applyEffects(\n        game,\n        {\n          log: `You burn hard, engines screaming. The pirate falls behind. (Escape ${(fleeChance * 100).toFixed(0)}%)`\n        },\n        rng\n      );\n    } else {\n      game.player.ship.hull = Math.max(0, game.player.ship.hull - 5);\n      game.player.risk.pirateAttention = Math.min(100, game.player.risk.pirateAttention + 5);\n      this.applyEffects(\n        game,\n        {\n          log: `You try to run, but the pirate tags you as you fail to break away. (Escape ${(fleeChance * 100).toFixed(0)}%)`,\n          flag: \"enemy_advantage\"\n        },\n        rng\n      );\n    }\n    return {\n      eventId: evt.id,\n      category: evt.category,\n      description: evt.description,\n      choiceId: choice.id,\n      outcome: success ? \"success\" : \"failure\",\n      delta: { fleeChance, roll, success }\n    };\n  }\n\n  private pickChoice(evt: EventDefinition, player: PlayerState, rng: Rng, choiceId?: string): EventChoice | null {\n    const fakeGame = { player } as GameState;\n    const eligible = evt.choices.filter((c) => this.meetsRequirements(c.requirements, fakeGame, null));\n    if (!eligible.length) return null;\n    if (choiceId) {\n      const found = eligible.find((c) => c.id === choiceId);\n      if (found) return found;\n    }\n    const idx = Math.floor(rng.next() * eligible.length);\n    return eligible[idx];\n  }\n\n  private pickOutcomeBranch(choice: EventChoice, rng: Rng): \"success\" | \"failure\" {\n    const successChance = choice.outcomes.success.chance;\n    const failureChance = choice.outcomes.failure?.chance ?? 0;\n    const total = successChance + failureChance;\n    const roll = rng.next() * total;\n    return roll <= successChance ? \"success\" : \"failure\";\n  }\n\n  private applyEffects(game: GameState, effects: EventEffect, rng: Rng): void {\n    if (typeof effects.credits === \"number\") {\n      adjustCredits(game.player, effects.credits);\n    }\n    if (typeof effects.fuel === \"number\") {\n      adjustFuel(game.player, effects.fuel);\n    }\n    if (effects.damage) {\n      applyDamage(game.player, effects.damage);\n    }\n    if (typeof effects.cargoLossChance === \"number\" && rng.next() <= effects.cargoLossChance) {\n      removeRandomCargo(game.player, rng.next);\n    }\n    if (effects.repChanges) {\n      adjustReputation(game.player, effects.repChanges);\n    }\n    if (effects.loot) {\n      adjustCredits(game.player, EFFECT_CONFIG.lootCredits[effects.loot] ?? 0);\n    }\n    if (effects.minerals) {\n      // Treat minerals as credits placeholder; could be piped to inventory system.\n      adjustCredits(game.player, EFFECT_CONFIG.mineralsYield[effects.minerals] * 20);\n    }\n    if (effects.mission_offer) {\n      createMissionOffer(game, effects.mission_offer, game.currentSectorId, rng);\n    }\n    if (effects.flag) {\n      addStatus(game.player, effects.flag);\n    }\n    if (effects.log) {\n      game.log.push({\n        cycle: game.time.cycle,\n        sectorId: game.currentSectorId,\n        message: effects.log\n      });\n    }\n    if (typeof effects.riskAdjust?.pirateAttention === \"number\") {\n      game.player.risk.pirateAttention = Math.max(\n        0,\n        Math.min(100, game.player.risk.pirateAttention + effects.riskAdjust.pirateAttention)\n      );\n    }\n  }\n}\n", "// src/systems/TravelSystem.ts\n// Movement, time progression, and event triggering.\n\nimport { Galaxy, Sector } from \"../../galaxyTypes\";\nimport { GameState, TravelResult, EventSelection } from \"../game/GameState\";\nimport { createPlayerState, appendLog, adjustFuel } from \"./PlayerState\";\nimport { EventEngine } from \"./EventEngine\";\nimport { Rng } from \"../rng/SeededRng\";\nimport { tickMissions } from \"./MissionSystem\";\nimport { applyTravelRisk, pirateEncounterChance, decayPirateAttention } from \"./RiskSystem\";\n\ninterface NewGameOptions {\n  name: string;\n  roleId: GameState[\"player\"][\"roleId\"];\n  startingCredits?: number;\n  startingFuel?: number;\n}\n\nexport function createNewGame(\n  galaxy: Galaxy,\n  options: NewGameOptions,\n  seed: number\n): GameState {\n  const startingSector = galaxy.sectors[0];\n  const player = createPlayerState(galaxy, {\n    name: options.name,\n    roleId: options.roleId,\n    startingCredits: options.startingCredits,\n    startingFuel: options.startingFuel\n  });\n\n  return {\n    seed,\n    galaxy,\n    currentSectorId: startingSector.id,\n    player,\n    time: { cycle: 0 },\n    activeMissions: [],\n    completedMissions: [],\n    failedMissions: [],\n    log: []\n  };\n}\n\nexport function travelToSector(\n  game: GameState,\n  destinationId: string,\n  rng: Rng,\n  eventEngine: EventEngine\n): TravelResult {\n  const current = findSector(game.galaxy, game.currentSectorId);\n  const dest = findSector(game.galaxy, destinationId);\n  const path = findPath(game.galaxy, current.id, dest.id);\n  if (!path.length) throw new Error(`No route from ${current.id} to ${dest.id}`);\n\n  let fuelSpent = 0;\n  const segments: TravelSegmentResult[] = [];\n  let lastEvent: EventSelection | null = null;\n\n  for (let i = 0; i < path.length - 1; i++) {\n    const fromId = path[i];\n    const toId = path[i + 1];\n    const fromSector = findSector(game.galaxy, fromId);\n    const toSector = findSector(game.galaxy, toId);\n\n    adjustFuel(game.player, -1);\n    fuelSpent += 1;\n    game.currentSectorId = toSector.id;\n    game.time.cycle += 1;\n    applyTravelRisk(game.player, toSector);\n\n    tickMissions(game);\n\n    let segmentEvent: EventSelection | null = null;\n    const pirateChance = pirateEncounterChance(game.player, toSector);\n    if (rng.next() < pirateChance) {\n      segmentEvent = eventEngine.rollSpecificEvent(game, \"pirate_encounter_lane\", toSector, rng);\n      decayPirateAttention(game.player, 20);\n    } else {\n      segmentEvent = eventEngine.rollEvent(game, toSector, rng) || null;\n    }\n\n    if (segmentEvent) lastEvent = segmentEvent;\n    segments.push({ fromId, toId, event: segmentEvent });\n  }\n\n  appendLog(game, `Traveled to ${dest.name}`, {\n    from: current.id,\n    to: dest.id,\n    event: lastEvent?.eventId ?? null\n  });\n\n  return {\n    path: { from: current, to: dest },\n    fuelSpent,\n    event: lastEvent || undefined,\n    segments\n  };\n}\n\nfunction findSector(galaxy: Galaxy, sectorId: string): Sector {\n  const sector = galaxy.sectors.find((s) => s.id === sectorId);\n  if (!sector) {\n    throw new Error(`Unknown sector ${sectorId}`);\n  }\n  return sector;\n}\n\ninterface TravelSegmentResult {\n  fromId: string;\n  toId: string;\n  event?: EventSelection | null;\n}\n\nfunction findPath(galaxy: Galaxy, startId: string, destId: string): string[] {\n  if (startId === destId) return [startId];\n  const queue: string[] = [startId];\n  const visited = new Set<string>([startId]);\n  const prev = new Map<string, string>();\n\n  while (queue.length) {\n    const current = queue.shift()!;\n    const sector = findSector(galaxy, current);\n    for (const neighbor of sector.connections) {\n      if (visited.has(neighbor)) continue;\n      visited.add(neighbor);\n      prev.set(neighbor, current);\n      queue.push(neighbor);\n      if (neighbor === destId) break;\n    }\n  }\n\n  if (!visited.has(destId)) return [];\n  const path: string[] = [];\n  let at = destId;\n  while (at) {\n    path.push(at);\n    const p = prev.get(at);\n    if (!p) break;\n    at = p;\n  }\n  return path.reverse();\n}\n", "{\n  \"commodities\": [\n    { \"id\": \"ore_aurite\", \"name\": \"Aurite Ore\", \"basePrice\": 40, \"tags\": [\"mineral\", \"industrial\"], \"legality\": \"legal\", \"category\": \"minerals\" },\n    { \"id\": \"ore_ironite\", \"name\": \"Ironite Ore\", \"basePrice\": 10, \"tags\": [\"mineral\", \"common\"], \"legality\": \"legal\", \"category\": \"minerals\" },\n    { \"id\": \"food_rations\", \"name\": \"Food Rations\", \"basePrice\": 8, \"tags\": [\"food\", \"basic\"], \"legality\": \"legal\", \"category\": \"food\" },\n    { \"id\": \"med_supplies\", \"name\": \"Medical Supplies\", \"basePrice\": 30, \"tags\": [\"medical\"], \"legality\": \"restricted\", \"category\": \"medical\" },\n    { \"id\": \"ai_cores\", \"name\": \"AI Cores\", \"basePrice\": 120, \"tags\": [\"high_tech\", \"illegal\"], \"legality\": \"illegal\", \"category\": \"tech\" }\n  ]\n}\n", "// src/systems/EconomySystem.ts\n// Trading, mining, and smuggling resolution using sector market/resource profiles.\n\nimport { Sector } from \"../../galaxyTypes\";\nimport { GameState } from \"../game/GameState\";\nimport {\n  addCargo,\n  adjustCredits,\n  adjustFuel,\n  adjustReputation,\n  appendLog,\n  removeCargo\n} from \"./PlayerState\";\nimport { createRng, Rng } from \"../rng/SeededRng\";\nimport commoditiesJson from \"../data/commodities.json\";\nimport { applyMiningRisk, MiningMode } from \"./RiskSystem\";\n\ntype VolumeLevel = \"none\" | \"low\" | \"medium\" | \"high\" | \"very_high\";\ntype VolatilityLevel = \"none\" | \"low\" | \"medium\" | \"high\";\ntype ToleranceLevel = \"n_a\" | \"very_low\" | \"low\" | \"medium\" | \"high\" | \"very_high\";\ntype RichnessLevel = \"low\" | \"medium\" | \"high\" | \"very_high\";\n\nexport interface Commodity {\n  id: string;\n  name: string;\n  basePrice: number;\n  tags: string[];\n  legality: \"legal\" | \"illegal\" | \"restricted\";\n  category: string;\n}\n\nexport interface MarketQuote {\n  commodity: Commodity;\n  buyPrice: number;\n  sellPrice: number;\n  availability: number;\n  legality: Commodity[\"legality\"];\n  notes?: string[];\n}\n\nconst ECONOMY_CONFIG = {\n  volumePriceAdjust: {\n    none: 0,\n    low: 0.04,\n    medium: 0,\n    high: -0.05,\n    very_high: -0.1\n  } as Record<VolumeLevel, number>,\n  volatilityRange: {\n    none: 0,\n    low: 0.05,\n    medium: 0.12,\n    high: 0.22\n  } as Record<VolatilityLevel, number>,\n  illegalMarkup: {\n    n_a: 0.05,\n    very_low: 0.25,\n    low: 0.18,\n    medium: 0.12,\n    high: 0.05,\n    very_high: -0.05\n  } as Record<ToleranceLevel, number>,\n  supplyMultiplier: 0.85,\n  demandMultiplier: 1.2,\n  sellSpread: 0.9,\n  availabilityBase: 4,\n  availabilityVolumeBonus: {\n    none: -2,\n    low: -1,\n    medium: 0,\n    high: 1,\n    very_high: 2\n  } as Record<VolumeLevel, number>,\n  miningYieldByRichness: {\n    low: 2,\n    medium: 4,\n    high: 6,\n    very_high: 8\n  } as Record<RichnessLevel, number>,\n  miningCreditPerUnit: 40,\n  miningFuelCost: 1,\n  smuggling: {\n    basePayoutPerUnit: 120,\n    detectionByLaw: {\n      none: 0.05,\n      very_low: 0.08,\n      low: 0.15,\n      medium: 0.28,\n      high: 0.4\n    } as Record<\"none\" | \"very_low\" | \"low\" | \"medium\" | \"high\", number>,\n    toleranceModifier: {\n      n_a: -0.02,\n      very_low: 0.08,\n      low: 0.05,\n      medium: 0,\n      high: -0.05,\n      very_high: -0.1\n    } as Record<ToleranceLevel, number>,\n    repEffect: {\n      threshold: 30,\n      reduction: 0.08 // detection reduction if syndicate rep high\n    },\n    penalties: {\n      navyRep: -4,\n      creditsFine: 200\n    },\n    rewards: {\n      syndicateRep: 2,\n      pirateRep: 1\n    }\n  }\n};\n\nconst CATALOG = (commoditiesJson as { commodities: Commodity[] }).commodities;\nconst COMMODITY_BY_ID = new Map<string, Commodity>(CATALOG.map((c) => [c.id, c]));\n\nexport interface TradeOrder {\n  type: \"buy\" | \"sell\";\n  commodityId: string;\n  quantity: number;\n}\n\nexport interface TradeResult {\n  commodity: Commodity;\n  unitPrice: number;\n  total: number;\n  success: boolean;\n  reason?: string;\n  notes?: string[];\n}\n\nexport interface MiningResult {\n  commodityId: string;\n  collected: number;\n  overflow: number;\n  fuelSpent: number;\n}\n\nexport interface SmugglingOrder {\n  cargoId: string;\n  quantity: number;\n}\n\nexport interface SmugglingResult {\n  success: boolean;\n  detection: boolean;\n  payout: number;\n}\n\nexport function getMarketQuotes(\n  game: GameState,\n  sector: Sector,\n  cycleOverride?: number\n): MarketQuote[] {\n  if (!sector.marketProfile || !sector.marketProfile.isTradeHub) return [];\n  const cycle = cycleOverride ?? game.time.cycle;\n  return CATALOG.map((commodity) => {\n    const priceRng = makePriceRng(game.seed, sector.id, commodity.id, cycle);\n    return deriveQuote(commodity, sector, priceRng);\n  });\n}\n\nexport function tradeCommodity(\n  game: GameState,\n  sector: Sector,\n  order: TradeOrder\n): TradeResult {\n  const quotes = getMarketQuotes(game, sector);\n  if (!quotes.length) {\n    return {\n      commodity: { id: order.commodityId, name: \"Unknown\", basePrice: 0, legality: \"legal\", category: \"\", tags: [] },\n      unitPrice: 0,\n      total: 0,\n      success: false,\n      reason: \"no_market\"\n    };\n  }\n  const quote = quotes.find((q) => q.commodity.id === order.commodityId);\n  if (!quote) {\n    return {\n      commodity: { id: order.commodityId, name: \"Unknown\", basePrice: 0, legality: \"legal\", category: \"\", tags: [] },\n      unitPrice: 0,\n      total: 0,\n      success: false,\n      reason: \"unknown_commodity\"\n    };\n  }\n\n  const total = quote.buyPrice * order.quantity;\n\n  if (order.type === \"buy\") {\n    if (game.player.credits < total) {\n      return { commodity: quote.commodity, unitPrice: quote.buyPrice, total, success: false, reason: \"insufficient_credits\" };\n    }\n    const added = addCargo(game.player, {\n      id: quote.commodity.id,\n      name: quote.commodity.name,\n      quantity: order.quantity,\n      legality: quote.commodity.legality\n    });\n    if (!added) {\n      return { commodity: quote.commodity, unitPrice: quote.buyPrice, total, success: false, reason: \"insufficient_cargo_space\" };\n    }\n    adjustCredits(game.player, -total);\n  } else {\n    const removed = removeCargo(game.player, order.commodityId, order.quantity);\n    if (!removed) {\n      return { commodity: quote.commodity, unitPrice: quote.sellPrice, total: quote.sellPrice * order.quantity, success: false, reason: \"insufficient_inventory\" };\n    }\n    adjustCredits(game.player, quote.sellPrice * order.quantity);\n  }\n\n  appendLog(game, `Trade ${order.type}`, {\n    commodity: order.commodityId,\n    quantity: order.quantity,\n    unitPrice: order.type === \"buy\" ? quote.buyPrice : quote.sellPrice,\n    total: order.type === \"buy\" ? total : quote.sellPrice * order.quantity\n  });\n\n  return {\n    commodity: quote.commodity,\n    unitPrice: order.type === \"buy\" ? quote.buyPrice : quote.sellPrice,\n    total: order.type === \"buy\" ? total : quote.sellPrice * order.quantity,\n    success: true,\n    notes: quote.notes\n  };\n}\n\n// Backwards compatibility wrapper for older call sites\nexport function resolveTrade(\n  game: GameState,\n  sector: Sector,\n  order: TradeOrder,\n  rng: Rng\n): TradeResult {\n  // rng retained for signature compatibility; pricing is deterministic from seed+sector+cycle.\n  return tradeCommodity(game, sector, order);\n}\n\nexport function resolveMining(\n  game: GameState,\n  sector: Sector,\n  rng: Rng,\n  mode: MiningMode = \"safe\"\n): MiningResult {\n  const richness = sector.resourceRichness.minerals as RichnessLevel;\n  const yieldUnits = ECONOMY_CONFIG.miningYieldByRichness[richness] ?? 0;\n  const variance = rng.next() * 0.3 + 0.85; // slight randomness 0.85-1.15\n  const finalYield = Math.max(1, Math.round(yieldUnits * variance));\n\n  const commodityId =\n    richness === \"very_high\" || richness === \"high\" ? \"ore_aurite\" : \"ore_ironite\";\n\n  adjustFuel(game.player, -ECONOMY_CONFIG.miningFuelCost);\n  applyMiningRisk(game.player, sector, mode);\n\n  const used = game.player.cargo.reduce((sum, c) => sum + c.quantity, 0);\n  const free = Math.max(0, game.player.ship.cargoCapacity - used);\n  const collected = Math.min(finalYield, free);\n  const overflow = finalYield - collected;\n  if (collected > 0) {\n    addCargo(game.player, { commodityId, quantity: collected });\n  }\n\n  appendLog(game, \"Mining operation\", {\n    sector: sector.id,\n    richness,\n    collected,\n    overflow,\n    commodityId\n  });\n\n  return {\n    commodityId,\n    collected,\n    overflow,\n    fuelSpent: ECONOMY_CONFIG.miningFuelCost\n  };\n}\n\nexport function resolveSmuggling(\n  game: GameState,\n  sector: Sector,\n  order: SmugglingOrder,\n  rng: Rng\n): SmugglingResult {\n  const removed = removeCargo(game.player, order.cargoId, order.quantity);\n  if (!removed) {\n    return { success: false, detection: false, payout: 0 };\n  }\n\n  const profile = sector.marketProfile;\n  const lawKey = sector.law as keyof typeof ECONOMY_CONFIG.smuggling.detectionByLaw;\n  const baseDetection = ECONOMY_CONFIG.smuggling.detectionByLaw[lawKey] ?? 0.2;\n  const tolerance = profile.illegalTolerance as ToleranceLevel;\n  const toleranceModifier = ECONOMY_CONFIG.smuggling.toleranceModifier[tolerance] ?? 0;\n  const repModifier =\n    (game.player.reputation[\"syndicate\"] ?? 0) >= ECONOMY_CONFIG.smuggling.repEffect.threshold\n      ? -ECONOMY_CONFIG.smuggling.repEffect.reduction\n      : 0;\n  const detectionChance = Math.max(0, baseDetection + toleranceModifier + repModifier);\n  const detected = rng.next() < detectionChance;\n\n  if (detected) {\n    adjustReputation(game.player, { navy: ECONOMY_CONFIG.smuggling.penalties.navyRep });\n    adjustCredits(game.player, -ECONOMY_CONFIG.smuggling.penalties.creditsFine);\n    appendLog(game, \"Smuggling attempt detected\", { sector: sector.id, detectionChance });\n    return { success: false, detection: true, payout: 0 };\n  }\n\n  const payout =\n    order.quantity *\n    (ECONOMY_CONFIG.smuggling.basePayoutPerUnit +\n      ECONOMY_CONFIG.smuggling.basePayoutPerUnit *\n        (ECONOMY_CONFIG.illegalMarkup[tolerance] ?? 0));\n\n  adjustCredits(game.player, payout);\n  adjustReputation(game.player, {\n    syndicate: ECONOMY_CONFIG.smuggling.rewards.syndicateRep,\n    pirate: ECONOMY_CONFIG.smuggling.rewards.pirateRep\n  });\n  appendLog(game, \"Smuggling success\", {\n    sector: sector.id,\n    payout,\n    detectionChance\n  });\n\n  return { success: true, detection: false, payout };\n}\n\nfunction deriveQuote(commodity: Commodity, sector: Sector, rng: Rng): MarketQuote {\n  const demandMulti = computeDemandMultiplier(commodity, sector);\n  const supplyMulti = computeSupplyMultiplier(commodity, sector);\n  const priceMultiplier = computePriceMultiplier(\n    commodity,\n    sector,\n    sector.marketProfile.volume as VolumeLevel,\n    sector.marketProfile.priceVolatility as VolatilityLevel,\n    sector.marketProfile.illegalTolerance as ToleranceLevel,\n    rng\n  );\n\n  const buyPrice = Math.max(1, Math.round(commodity.basePrice * priceMultiplier * demandMulti * supplyMulti));\n  const sellPrice = Math.max(1, Math.round(buyPrice * ECONOMY_CONFIG.sellSpread));\n  const notes: string[] = [];\n  if (demandMulti > 1) notes.push(\"Local demand raises price\");\n  if (supplyMulti < 1) notes.push(\"Local supply lowers price\");\n  if (commodity.legality !== \"legal\") notes.push(\"Risk: restricted/illegal cargo\");\n\n  const availability =\n    ECONOMY_CONFIG.availabilityBase +\n    (ECONOMY_CONFIG.availabilityVolumeBonus[sector.marketProfile.volume as VolumeLevel] ?? 0) +\n    (supplyMulti < 1 ? 1 : 0) -\n    (commodity.legality !== \"legal\" ? 1 : 0);\n\n  return {\n    commodity,\n    buyPrice,\n    sellPrice,\n    availability: Math.max(1, availability),\n    legality: commodity.legality,\n    notes\n  };\n}\n\nfunction computePriceMultiplier(\n  commodity: Commodity,\n  sector: Sector,\n  volume: VolumeLevel,\n  volatility: VolatilityLevel,\n  tolerance: ToleranceLevel,\n  rng: Rng\n): number {\n  const volumeAdj = ECONOMY_CONFIG.volumePriceAdjust[volume] ?? 0;\n  const swing = ECONOMY_CONFIG.volatilityRange[volatility] ?? 0;\n  const variance = swing ? rng.next() * swing * 2 - swing : 0; // symmetric variance\n  const illegalAdj =\n    commodity.legality === \"illegal\" || commodity.legality === \"restricted\"\n      ? ECONOMY_CONFIG.illegalMarkup[tolerance] ?? 0\n      : 0;\n  return 1 + volumeAdj + variance + illegalAdj;\n}\n\nfunction hasTagMatch(sectorTags: string[], targetTags: string[]): boolean {\n  return targetTags.some((t) => sectorTags.includes(t));\n}\n\nfunction computeDemandMultiplier(commodity: Commodity, sector: Sector): number {\n  const demand = sector.marketProfile?.demandProfile;\n  if (!demand) return 1;\n  let multiplier = 1;\n  if (demand.byTag) {\n    for (const tag of commodity.tags) {\n      multiplier *= demand.byTag[tag] ?? 1;\n    }\n  }\n  if (demand.byCommodity && demand.byCommodity[commodity.id]) {\n    multiplier *= demand.byCommodity[commodity.id];\n  }\n  return multiplier;\n}\n\nfunction computeSupplyMultiplier(commodity: Commodity, sector: Sector): number {\n  const supply = sector.marketProfile?.supplyProfile;\n  if (!supply) return 1;\n  let multiplier = 1;\n  if (supply.byTag) {\n    for (const tag of commodity.tags) {\n      multiplier *= supply.byTag[tag] ?? 1;\n    }\n  }\n  if (supply.byCommodity && supply.byCommodity[commodity.id]) {\n    multiplier *= supply.byCommodity[commodity.id];\n  }\n  // supply lowers price when multiplier > 1\n  return multiplier > 1 ? 1 / multiplier : multiplier;\n}\n\nfunction makePriceRng(baseSeed: number, sectorId: string, commodityId: string, cycle: number): Rng {\n  const combined = hashSeed(`${baseSeed}:${sectorId}:${commodityId}:${cycle}`);\n  return createRng(combined);\n}\n\nfunction hashSeed(input: string): number {\n  let h = 0;\n  for (let i = 0; i < input.length; i++) {\n    h = (h << 5) - h + input.charCodeAt(i);\n    h |= 0;\n  }\n  return Math.abs(h) || 1;\n}\n", "// src/systems/CombatSystem.ts\n// Dice-based combat resolution with role, module, crew, and reputation modifiers.\n\nimport { Sector } from \"../../galaxyTypes\";\nimport { GameState } from \"../game/GameState\";\nimport { applyDamage, adjustCredits, adjustReputation, appendLog } from \"./PlayerState\";\nimport { Rng } from \"../rng/SeededRng\";\n\ntype EnemyType = \"pirate\" | \"navy\" | \"smuggler\" | \"bounty_target\";\ntype EnemyStrength = \"light\" | \"standard\" | \"elite\";\n\nexport interface CombatScenario {\n  sector: Sector;\n  enemyType: EnemyType;\n  strength?: EnemyStrength;\n}\n\nexport interface CombatResult {\n  outcome: \"win\" | \"loss\";\n  playerRoll: number;\n  enemyRoll: number;\n  damageTaken?: \"light\" | \"medium\" | \"heavy\";\n  creditsDelta: number;\n  repChanges?: Record<string, number>;\n}\n\nconst COMBAT_CONFIG = {\n  baseEnemyByDanger: {\n    low: { attack: 12, defense: 10 },\n    medium: { attack: 18, defense: 16 },\n    high: { attack: 24, defense: 20 }\n  },\n  strengthModifier: {\n    light: -4,\n    standard: 0,\n    elite: 6\n  },\n  enemyTypeAggression: {\n    pirate: 4,\n    navy: 6,\n    smuggler: -2,\n    bounty_target: 2\n  },\n  roleBonuses: {\n    navy: { attack: 4, defense: 4 },\n    bounty_hunter: { attack: 4, defense: 2 },\n    pirate: { attack: 3, defense: 1 },\n    smuggler: { attack: 1, defense: 1 },\n    trader: { attack: 0, defense: 0 },\n    miner: { attack: 0, defense: 1 },\n    explorer: { attack: 1, defense: 1 },\n    salvager: { attack: 1, defense: 2 }\n  },\n  moduleBonuses: {\n    weapons: {\n      civilian_lasers: 2\n    },\n    engines: {\n      basic_thrusters: 1\n    },\n    scanners: {\n      short_range_scanner: 1\n    }\n  },\n  defenseMitigationFactor: 0.25,\n  playerDefenseBoost: 0.1,\n  repAggression: {\n    pirate: { threshold: 40, attackMod: -4 },\n    navy: { threshold: -30, attackMod: 4 }\n  },\n  lootByStrength: {\n    light: 120,\n    standard: 260,\n    elite: 520\n  },\n  repOnWin: {\n    pirate: { pirate: -3, navy: 1 },\n    navy: { pirate: -1, navy: 2 },\n    smuggler: { merchant: 1, pirate: -1 },\n    bounty_target: { navy: 1, merchant: 1 }\n  }\n};\n\nexport function resolveCombat(\n  game: GameState,\n  scenario: CombatScenario,\n  rng: Rng\n): CombatResult {\n  const strength: EnemyStrength = scenario.strength ?? \"standard\";\n  const baseEnemy = COMBAT_CONFIG.baseEnemyByDanger[scenario.sector.danger] ?? COMBAT_CONFIG.baseEnemyByDanger.medium;\n  const enemyAttack =\n    baseEnemy.attack +\n    COMBAT_CONFIG.strengthModifier[strength] +\n    (COMBAT_CONFIG.enemyTypeAggression[scenario.enemyType] ?? 0) +\n    reputationAggressionMod(game, scenario.enemyType);\n  const enemyDefense = baseEnemy.defense + COMBAT_CONFIG.strengthModifier[strength];\n\n  const playerAttack = computePlayerAttack(game);\n  const playerDefense = computePlayerDefense(game);\n\n  const playerRoll =\n    rng.int(1, 100) +\n    playerAttack +\n    Math.floor(playerDefense * COMBAT_CONFIG.playerDefenseBoost);\n  const enemyRoll =\n    rng.int(1, 100) +\n    enemyAttack -\n    Math.floor(playerDefense * COMBAT_CONFIG.defenseMitigationFactor);\n\n  let outcome: \"win\" | \"loss\" = \"win\";\n  let damageTaken: \"light\" | \"medium\" | \"heavy\" | undefined;\n  let creditsDelta = 0;\n  let repChanges: Record<string, number> | undefined;\n\n  if (playerRoll >= enemyRoll) {\n    creditsDelta = COMBAT_CONFIG.lootByStrength[strength] ?? 0;\n    adjustCredits(game.player, creditsDelta);\n    repChanges = COMBAT_CONFIG.repOnWin[scenario.enemyType];\n    if (repChanges) adjustReputation(game.player, repChanges);\n  } else {\n    outcome = \"loss\";\n    const margin = enemyRoll - playerRoll;\n    damageTaken = margin > 25 ? \"heavy\" : margin > 12 ? \"medium\" : \"light\";\n    applyDamage(game.player, damageTaken);\n    creditsDelta = 0;\n  }\n\n  appendLog(game, \"Combat resolved\", {\n    enemyType: scenario.enemyType,\n    strength,\n    outcome,\n    playerRoll,\n    enemyRoll,\n    damageTaken,\n    creditsDelta\n  });\n\n  return { outcome, playerRoll, enemyRoll, damageTaken, creditsDelta, repChanges };\n}\n\nfunction computePlayerAttack(game: GameState): number {\n  const ship = game.player.ship;\n  const base = ship.weaponDamage + Math.floor(ship.enginePower / 2);\n  const roleBonus = COMBAT_CONFIG.roleBonuses[game.player.roleId]?.attack ?? 0;\n  const moduleBonus =\n    (game.player.modules.weapons ?? []).reduce(\n      (sum, mod) => sum + (COMBAT_CONFIG.moduleBonuses.weapons[mod] ?? 0),\n      0\n    ) +\n    (game.player.modules.engines ?? []).reduce(\n      (sum, mod) => sum + (COMBAT_CONFIG.moduleBonuses.engines[mod] ?? 0),\n      0\n    );\n  return base + roleBonus + moduleBonus;\n}\n\nfunction computePlayerDefense(game: GameState): number {\n  const ship = game.player.ship;\n  const base = ship.shields + Math.floor(ship.evasion / 2);\n  const roleBonus = COMBAT_CONFIG.roleBonuses[game.player.roleId]?.defense ?? 0;\n  const moduleBonus = (game.player.modules.scanners ?? []).reduce(\n    (sum, mod) => sum + (COMBAT_CONFIG.moduleBonuses.scanners[mod] ?? 0),\n    0\n  );\n  return base + roleBonus + moduleBonus;\n}\n\nfunction reputationAggressionMod(game: GameState, enemyType: EnemyType): number {\n  if (enemyType === \"pirate\") {\n    const rep = game.player.reputation[\"pirate\"] ?? 0;\n    if (rep >= COMBAT_CONFIG.repAggression.pirate.threshold) {\n      return COMBAT_CONFIG.repAggression.pirate.attackMod;\n    }\n  }\n  if (enemyType === \"navy\") {\n    const rep = game.player.reputation[\"navy\"] ?? 0;\n    if (rep <= COMBAT_CONFIG.repAggression.navy.threshold) {\n      return COMBAT_CONFIG.repAggression.navy.attackMod;\n    }\n  }\n  return 0;\n}\n", "// web/client.ts\n// Minimal text-based browser client to play the loop: travel -> event -> log.\n\nimport { GalaxyGenerator } from \"../galaxyGenerator\";\nimport { GalaxyConfig, Sector } from \"../galaxyTypes\";\nimport galaxyConfigJson from \"../galaxy_generator.json\";\nimport { createRng } from \"../src/rng/SeededRng\";\nimport { EventEngine } from \"../src/systems/EventEngine\";\nimport { createNewGame, travelToSector } from \"../src/systems/TravelSystem\";\nimport { resolveMining, getMarketQuotes, tradeCommodity } from \"../src/systems/EconomySystem\";\nimport { resolveCombat } from \"../src/systems/CombatSystem\";\n\ntype HTMLElementMap = {\n  sectorName: HTMLElement;\n  sectorMeta: HTMLElement;\n  connections: HTMLElement;\n  playerStats: HTMLElement;\n  log: HTMLElement;\n  missions: HTMLElement;\n  guidance: HTMLElement;\n  marketList: HTMLElement;\n};\n\nconst galaxyConfig = galaxyConfigJson as GalaxyConfig;\n\nconst seed = 1337;\nconst rng = createRng(seed);\nconst galaxy = new GalaxyGenerator(galaxyConfig, seed).generate(\"medium\");\nlet game = createNewGame(galaxy, { name: \"Browser Captain\", roleId: \"trader\" }, seed);\nconst eventEngine = new EventEngine(galaxy);\n\nconst dom: HTMLElementMap = {\n  sectorName: getEl(\"sector-name\"),\n  sectorMeta: getEl(\"sector-meta\"),\n  connections: getEl(\"connections\"),\n  playerStats: getEl(\"player-stats\"),\n  log: getEl(\"log\"),\n  missions: getEl(\"missions\"),\n  guidance: getEl(\"guidance\"),\n  marketList: getEl(\"market-list\")\n};\n\nfunction getEl(id: string): HTMLElement {\n  const el = document.getElementById(id);\n  if (!el) throw new Error(`Missing element #${id}`);\n  return el;\n}\n\nfunction travel(toId: string): void {\n  try {\n    const res = travelToSector(game, toId, rng, eventEngine);\n    const sector = findSector(toId);\n    if (res.event) {\n      appendLogLine(\n        `Event: ${res.event.eventId} (${res.event.category}) outcome=${res.event.outcome}`\n      );\n    }\n    appendLogLine(`Travelled to ${sector.name}`);\n  } catch (err) {\n    appendLogLine(`Travel failed: ${(err as Error).message}`);\n  }\n  render();\n}\n\nfunction mine(): void {\n  const sector = findSector(game.currentSectorId);\n  const result = resolveMining(game, sector, rng, \"safe\");\n  appendLogLine(`Mined ${result.collected} ${result.commodityId}${result.overflow ? ` (overflow ${result.overflow})` : \"\"}`);\n  render();\n}\n\nfunction buyCommodity(commodityId: string): void {\n  const sector = findSector(game.currentSectorId);\n  const result = tradeCommodity(game, sector, { type: \"buy\", commodityId, quantity: 1 });\n  appendLogLine(\n    result.success\n      ? `Bought ${commodityId} @ ${result.unitPrice}`\n      : `Buy failed: ${result.reason}`\n  );\n  render();\n}\n\nfunction sellCommodity(commodityId: string): void {\n  const sector = findSector(game.currentSectorId);\n  const result = tradeCommodity(game, sector, { type: \"sell\", commodityId, quantity: 1 });\n  appendLogLine(\n    result.success\n      ? `Sold ${commodityId} @ ${result.unitPrice}`\n      : `Sell failed: ${result.reason}`\n  );\n  render();\n}\n\nfunction combatSample(): void {\n  const sector = findSector(game.currentSectorId);\n  const result = resolveCombat(game, { sector, enemyType: \"pirate\" }, rng);\n  appendLogLine(\n    `Combat vs pirate: ${result.outcome} (you ${result.playerRoll} / foe ${result.enemyRoll})`\n  );\n  render();\n}\n\nfunction findSector(id: string): Sector {\n  const sector = galaxy.sectors.find((s) => s.id === id);\n  if (!sector) throw new Error(`Unknown sector ${id}`);\n  return sector;\n}\n\nfunction appendLogLine(line: string): void {\n  game.log.push({\n    cycle: game.time.cycle,\n    sectorId: game.currentSectorId,\n    message: line\n  });\n}\n\nfunction render(): void {\n  const sector = findSector(game.currentSectorId);\n  dom.sectorName.textContent = sector.name;\n  dom.sectorMeta.textContent = [\n    `Type: ${sector.typeId}`,\n    `Faction: ${sector.factionId ?? \"Unclaimed\"}`,\n    `Danger: ${sector.danger}`,\n    `Law: ${sector.law}`\n  ].join(\" | \");\n\n  dom.connections.innerHTML = \"\";\n  sector.connections.forEach((connId) => {\n    const connSector = findSector(connId);\n    const button = document.createElement(\"button\");\n    button.textContent = connSector.name;\n    button.onclick = () => travel(connId);\n    dom.connections.appendChild(button);\n  });\n\n  dom.playerStats.textContent = [\n    `Credits: ${game.player.credits}`,\n    `Fuel: ${game.player.fuel}/${game.player.maxFuel}`,\n    `Hull: ${game.player.ship.hull}/${game.player.ship.maxHull}`,\n    `Shields: ${game.player.ship.shields}/${game.player.ship.maxShields}`,\n    `Role: ${game.player.roleId}`\n  ].join(\" | \");\n\n  dom.missions.textContent = game.activeMissions\n    .map((m) => `${m.missionId} (${m.status}) exp:${m.expiresIn ?? \"-\"} reward:${m.reward}`)\n    .join(\"\\n\");\n\n  renderMarket(sector);\n\n  dom.log.textContent = game.log\n    .slice(-10)\n    .map((l) => `[c${l.cycle}] ${l.message}`)\n    .join(\"\\n\");\n\n  dom.guidance.textContent = buildGuidance(sector);\n}\n\nfunction wireControls(): void {\n  getEl(\"btn-mine\").addEventListener(\"click\", () => mine());\n  getEl(\"btn-combat\").addEventListener(\"click\", () => combatSample());\n}\n\nwireControls();\nrender();\n\nfunction renderMarket(sector: Sector): void {\n  dom.marketList.innerHTML = \"\";\n  const quotes = getMarketQuotes(game, sector);\n  if (!quotes.length) {\n    dom.marketList.textContent = \"No market in this sector.\";\n    return;\n  }\n  quotes.forEach((q) => {\n    const row = document.createElement(\"div\");\n    row.textContent = `${q.commodity.name}: buy ${q.buyPrice} / sell ${q.sellPrice}`;\n    const buyBtn = document.createElement(\"button\");\n    buyBtn.textContent = \"Buy +1\";\n    buyBtn.onclick = () => buyCommodity(q.commodity.id);\n    const sellBtn = document.createElement(\"button\");\n    sellBtn.textContent = \"Sell -1\";\n    sellBtn.onclick = () => sellCommodity(q.commodity.id);\n    row.appendChild(buyBtn);\n    row.appendChild(sellBtn);\n    dom.marketList.appendChild(row);\n  });\n}\n\nfunction buildGuidance(sector: Sector): string {\n  const messages: string[] = [];\n  messages.push(\"Click a connection to travel. Each jump advances time and can trigger events.\");\n  if (sector.tags.includes(\"mining\")) messages.push(\"This is a mining sector; run Mine for steady credits.\");\n  if (sector.tags.includes(\"black_market\")) messages.push(\"Black market here: smuggling pays, but law/rep risks rise.\");\n  if (sector.tags.includes(\"core\")) messages.push(\"Core systems: safer travel, better markets, fewer pirate events.\");\n  if ((game.player.fuel / game.player.maxFuel) < 0.3) messages.push(\"Fuel is low; travel sparingly until you reach a safer hub.\");\n  if (game.player.ship.hull < game.player.ship.maxHull * 0.5) messages.push(\"Hull is damaged; avoid combat until repaired.\");\n  if (!messages.length) messages.push(\"Explore freely: travel, mine, trade, or test combat.\");\n  return messages.join(\"\\n\u2022 \");\n}\n"],
  "mappings": "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",
  "names": ["seed", "rng", "config", "galaxy", "other", "seed", "galaxy", "rng", "game", "game", "rng", "game", "galaxy", "game", "rng", "galaxy", "seed", "game", "rng", "eventEngine", "game", "game", "rng", "rng", "game", "rng", "findSector"]
}
